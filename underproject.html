<!DOCTYPE HTML>
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>undercat</title>
    <style>
        body {
            background-color: black;
        }

        canvas {
            background-color: black;
            margin: auto;
            display: block;
        }

        #text {
            display: none;
            position: absolute;
            left: 60%;
            top: 3%
        }

        img {
            max-width: 100%;
            max-height: 100%;
        }

        #container0 {
            display: block;
            margin: auto;
            width: 500px;
            color: white;
            text-align: center;
            font-family: 'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS', sans-serif;
            font-size: 15px;
        }

        #container {
            display: none;
            margin: auto;
            width: 300px;
        }

        #container2 {
            display: none;
            width: 300px;
            margin: auto;
        }

        #container3 {
            display: none;
            width: 300px;
            margin: auto;
        }

        #container4 {
            display: none;
            width: 300px;
            margin: auto;
        }

        #container5 {
            width: 1200px;
            margin: auto;
            display: none;
        }

        #container6 {
            width: 1200px;
            margin: auto;
            display: none;
        }

        #container7 {
            width: 1200px;
            margin: auto;
            display: none;
        }

        #container8 {
            display: none;
            width: 300px;
            margin: auto;
        }

        #container9 {
            display: none;
            width: 300px;
            margin: auto;
        }

        #container10 {
            display: none;
            width: 300px;
            margin: auto;
        }

        #container11 {
            display: none;
            width: 300px;
            margin: auto;
        }

        #container12 {
            width: 750px;
            margin: auto;
            display: none;
            color: white;
            text-align: center;
            font-family: 'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS', sans-serif;
            font-size: 25px;
        }

        #container13 {
            display: none;
            width: 300px;
            margin: auto;
        }

        #container14 {
            display: none;
            width: 300px;
            margin: auto;
        }

        #container15 {
            display: none;
            width: 300px;
            margin: auto;
        }

        #container16 {
            display: none;
            width: 300px;
            margin: auto;
        }

        #container17 {
            display: none;
            width: 300px;
            margin: auto;
        }

        #container18 {
            width: 750px;
            margin: auto;
            display: none;
            color: white;
            text-align: center;
            font-family: 'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS', sans-serif;
            font-size: 25px;
        }
    </style>
</head>

<body>

    <canvas id="vieCanvas"></canvas>

    <div id="container0"><img src="./undercat.jpg"><br>
        *use the arrow keys to move, enter to select and shift to go back
    </div>
    <div id="container"><img src="./cat.GIF"></div>
    <div id="container2"><img src="./madcat.GIF"></div>
    <div id="container3"><img src="./slice.GIF"></div>
    <div id="container4"><img src="./miss.GIF"></div>
    <div id="container5"><img src="./gameover.gif"></div>
    <div id="container6"><img src="./gameoversuite.gif"></div>
    <div id="container7"><img src="./gameoverencore.png"></div>
    <div id="container8"><img src="./phase2.GIF"></div>
    <div id="container9"><img src="./surprised.PNG"></div>
    <div id="container10"><img src="./blocked.GIF"></div>
    <div id="container11"><img src="./madmiss.GIF"></div>
    <div id="container12"><img src="./undercat.jpg"><br>
        NUTRAL ENDING<br><br><br>
        game by the the smart and sexy Willywello<br>
        inspired a bit by undertale from Toby Fox<br>
        music from the soundtrack of Hiveswap<br>
    </div>
    <div id="container13"><img src="./catslices.GIF"></div>
    <div id="container14"><img src="./catdying.GIF"></div>
    <div id="container15"><img src="./genoux.GIF"></div>
    <div id="container16"><img src="./laststrike.GIF"></div>
    <div id="container17"><img src="./catgobye.GIF"></div>
    <div id="container18"><img src="./undercat.jpg"><br>
        GENOCIDE ENDING<br><br><br>
        game by the the smart and sexy Willywello<br>
        inspired a bit by undertale from Toby Fox<br>
        music from the soundtrack of Hiveswap<br>
    </div>

    <canvas id="text"></canvas>
    <canvas id="monCanvas"></canvas>

    <script>

//var images
        var fight = new Image()
        fight.src = "./fight.jpg"

        var act = new Image()
        act.src = "./act.jpg"

        var item = new Image()
        item.src = "./item.jpg"

        var mercy = new Image()
        mercy.src = "./mercy.jpg"

        var sfight = new Image()
        sfight.src = "./sfight.jpg"

        var sact = new Image()
        sact.src = "./sact.jpg"

        var sitem = new Image()
        sitem.src = "./sitem.jpg"

        var smercy = new Image()
        smercy.src = "./smercy.jpg"

        var coeur = new Image()
        coeur.src = "./coeur.PNG"

        var cible = new Image()
        cible.src = "./cible.jpg"

//var sonds
        var music = new Audio()
        music.src = "menumusic.mp3"

        var hurt = new Audio()
        hurt.src = "damage.mp3"

        var sclick = new Audio()
        sclick.src = "click.mp3"

        var soulshatter = new Audio()
        soulshatter.src = "soulshatter.mp3"

        var attackingsound = new Audio()
        attackingsound.src = "attackingsound.mp3"

        //canvas
        var canvas = document.getElementById("monCanvas")
        var c = canvas.getContext("2d")
        canvas.width = 1000
        canvas.height = 400

        var canvasv = document.getElementById("vieCanvas")
        var cv = canvasv.getContext("2d")
        canvasv.width = 200
        canvasv.height = 20

        var canvast = document.getElementById("text")
        var ct = canvast.getContext("2d")
        canvast.width = 500
        canvast.height = 300

        //var du jeu
        var keyDown = {}

        var joueur = {
            x: 50,//300
            y: canvas.height / 2.3,//canvas.height - 47
            w: 20,
            h: 20,
            color: "lime",
            speed: 5,
            velocity: 7.5
        }

        var healthbar = {
            x: 400,
            y: 300,
            w: 100,
            h: 20,
            color: "yellow",
        }

        var contour = {
            x: 0,
            y: 0,
            w: 1000,
            h: 290,
            color: "white",
        }

        var boite = {
            x: contour.x + 10,
            y: contour.y + 10,
            w: contour.w - 20,
            h: contour.h - 20,
            color: "black",
        }

        var attbar = {
            x: -100,
            y: 0,
            w: 20,
            h: 290,
            color: "grey",
            speed: 10
        }

        var bossvie = {
            x: 0,
            y: 0,
            w: 200,
            h: 20,
            color: "lime",
        }

        var shield = {
            x: -100,
            y: -100,
            w: 20,
            h: 20,
            color: "darkblue",
        }

        var clicked = false

        var combat = false

        var bouton = 0

        var attacking = false

        var transition = false

        var damage = 0

        var attack = -1

        var sac = []

        var sacb = []

        var saco = []

        var sacj = []

        var wait = false

        var hit = false

        var gravity = -1

        var jump = false

        var lastatt = -1

        var phase = 1

        var speak = false

        var combat2 = false

        var lastxy = {
            x: 0,
            y: 0
        }

        var dialogue = 0

        var items = {
            pie: 2,
            cake: 3,
            steroids: 2,
            candy: 5,
            noodles: 2,
            nood: 0,
            ster: 0
        }

        var menu = 0

        var checkpoints = false

        var degat = 20

        var wasd = false 

        //interface, missiles, dialogues
        function draw() {

            if (menu == 0) {
                c.drawImage(coeur, joueur.x, joueur.y, joueur.w, joueur.h)
                c.font = "20px Comic Sans MS"
                c.fillText("*work in progress*", 850, canvas.height / 1.7)
                c.font = "50px Comic Sans MS"
                c.fillStyle = "white"
                c.textAlign = "center"
                c.fillText("PLAY", 150, canvas.height / 2)
                c.fillText("RULES", 500, canvas.height / 2)
                c.fillText("TROPHIES", 850, canvas.height / 2)
            } else if (menu == 1) {
                c.drawImage(coeur, joueur.x, joueur.y, joueur.w, joueur.h)
                c.fillText("EASY", 150, canvas.height / 2)
                c.fillText("NORMAL", 500, canvas.height / 2)
                c.fillText("VERY HARD", 850, canvas.height / 2)
            } else if (menu == 2) {
                c.drawImage(coeur, joueur.x, joueur.y, joueur.w, joueur.h)
                c.fillText("CHECKPOINTS?", canvas.width / 2, canvas.height / 3)
                c.fillText("NO", 360, canvas.height / 2)
                c.fillText("YES", 600, canvas.height / 2)
            } else if (menu == 3) {
                if (joueur.x == 50 && bouton == 0 && combat == false) {
                    c.drawImage(sfight, 0, canvas.height - 100, 250, 125)
                } else {
                    c.drawImage(fight, 25, canvas.height - 75, 200, 75)
                }

                if (joueur.x == 300 && bouton == 0 && combat == false) {
                    c.drawImage(sact, 250, canvas.height - 100, 250, 125)
                } else {
                    c.drawImage(act, 275, canvas.height - 75, 200, 75)
                }

                if (joueur.x == 550 && bouton == 0 && combat == false) {
                    c.drawImage(sitem, 500, canvas.height - 100, 245, 120)
                } else {
                    c.drawImage(item, 525, canvas.height - 75, 200, 75)
                }

                if (joueur.x == 800 && bouton == 0 && combat == false) {
                    c.drawImage(smercy, 750, canvas.height - 100, 240, 115)
                } else {
                    c.drawImage(mercy, 775, canvas.height - 75, 200, 75)
                }

                c.font = "25px Comic Sans MS"
                c.textAlign = "left"
                c.fillStyle = "white"
                c.fillText("FRISK      LV1                       HP", 0, 315)
                c.fillText(healthbar.w / 5 + "/20", 550, 315)
                if (healthbar.w > 100) {
                    healthbar.w = 100
                }

                c.fillStyle = "red"
                c.fillRect(400, 300, 100, 20)
                c.fillStyle = healthbar.color
                c.fillRect(healthbar.x, healthbar.y, healthbar.w, healthbar.h)

                if (attack >= 0 && contour.x != 300 && combat == true) {
                    contour.x += 15
                    contour.w -= 30
                    boite.x += 15
                    boite.w -= 30
                }

                c.fillStyle = contour.color
                c.fillRect(contour.x, contour.y, contour.w, contour.h)
                c.fillStyle = boite.color
                c.fillRect(boite.x, boite.y, boite.w, boite.h)

                c.font = "30px Comic Sans MS"
                c.textAlign = "left"
                c.fillStyle = "white"
                if (bouton == 1 && attacking == false && combat == false) {
                    c.fillText(" * Pixie", 70, 70)
                    c.fillStyle = "red"
                    c.fillRect(200, 50, 200, bossvie.h)
                    c.fillStyle = bossvie.color
                    c.fillRect(200, 50, bossvie.w, bossvie.h)
                }
                else if (bouton == 2) {
                    c.fillText(" * Pixie", 70, 70)
                }
                else if (bouton == 2.5 && combat == false) {
                    c.fillText(" * check", 70, 70)
                }
                else if (bouton == 3 && combat == false) {
                    c.font = "25px Comic Sans MS"
                    c.fillText(" * noodles x" + items.noodles, 70, 70)
                    c.fillText(" * steroids x" + items.steroids, 270, 70)
                    c.fillText(" * candy x" + items.candy, 470, 70)
                    c.fillText(" * cake x" + items.cake, 670, 70)
                    c.fillText(" * pie x" + items.pie, 870, 70)
                    if (joueur.x == 49) {
                        c.fillText("Noodles:   +2HP", 50, 150)
                        c.fillText("The damage you receive is cut in half during the 2 next attacks.", 50, 190)
                        c.fillText("Delicious and practicle! Don't get used to it.", 50, 230)
                    } else if (joueur.x == 249) {
                        c.fillText("Steroids:   -5HP", 50, 150)
                        c.fillText("The damage you deal is multiplied by 2 during your 2 next attacks.", 50, 190)
                        c.fillText("Don't be scared of the warnings behind the box.", 50, 230)
                    } else if (joueur.x == 449) {
                        c.fillText("Candy:   +5HP", 50, 150)
                        c.fillText("Just a little treat.", 50, 190)
                        c.fillText("Eat with moderation.", 50, 230)
                    } else if (joueur.x == 649) {
                        c.fillText("Cake:   +10HP", 50, 150)
                        c.fillText("Is it a lie?", 50, 190)
                        c.fillText("There's only one way to find out.", 50, 230)
                    } else if (joueur.x == 849) {
                        c.fillText("Pie:   +20HP", 50, 150)
                        c.fillText("Dessert in the middle of a fight?", 50, 190)
                        c.fillText("I wouldn't recommend it, but it looks so good!", 50, 230)
                    }
                }
                else if (bouton == 4) {
                    if (phase == 2) {
                        c.fillStyle = "yellow"
                    }
                    c.fillText(" * spare", 70, 70)
                }

                c.drawImage(coeur, joueur.x, joueur.y, joueur.w, joueur.h)
                if (gravity == 0) {
                    coeur.src = "blueheart.PNG"
                } else if (gravity == 1) {
                    coeur.src = "upsideheart.PNG"
                } else if (gravity == 2) {
                    coeur.src = "leftheart.PNG"
                } else if (gravity == 3) {
                    coeur.src = "rightheart.PNG"
                } else if (gravity == 4) {
                    c.fillStyle = shield.color
                    c.fillRect(shield.x, shield.y, shield.w, shield.h)
                    coeur.src = "greenheart.PNG"
                } else {
                    shield.x = -100
                    coeur.src = "coeur.PNG"
                }

                if (attacking == true) {
                    attbar.x += attbar.speed
                    c.drawImage(cible, boite.x, boite.y, boite.w, boite.h)
                }
                c.fillStyle = attbar.color
                c.fillRect(attbar.x, attbar.y, attbar.w, attbar.h)

                if (transition == true) {
                    cv.fillStyle = "grey"
                    cv.fillRect(bossvie.x, bossvie.y, 200, bossvie.h)
                    cv.fillStyle = bossvie.color
                    cv.fillRect(bossvie.x, bossvie.y, bossvie.w, bossvie.h)
                    cv.font = "20px Comic Sans MS"
                    cv.textAlign = "center"
                    cv.fillStyle = "red"
                    if (bossvie.w > 150 && bossvie.w <= 200) {
                        cv.fillText("-" + damage, 100, 18)
                    } else if (bossvie.w > 100 && bossvie.w <= 150) {
                        cv.fillText("-" + damage * 17, 100, 18)
                    } else if (bossvie.w > 50 && bossvie.w <= 100) {
                        cv.fillText("-" + damage * 185, 100, 18)
                    } else if (bossvie.w > 10 && bossvie.w <= 50) {
                        cv.fillText("-" + damage * 1482, 100, 18)
                    }else if (bossvie.w == 10) {
                        cv.fillText("-" + damage , 100, 18)
                    } else if (bossvie.w == 1) {
                        cv.fillText("-" + damage * 57360413, 100, 18)
                    } else if (bossvie.w < 1) {
                        cv.fillText("-" + damage * 5070306000401030, 100, 18)
                    }
                }

                for (i = 0; i < sacb.length; i++) {
                    sacb[i].draw()
                }

                for (i = 0; i < saco.length; i++) {
                    saco[i].draw()
                }

                for (i = 0; i < sac.length; i++) {
                    sac[i].draw()
                }

                for (i = 0; i < sacj.length; i++) {
                    sacj[i].draw()
                }

                ct.font = "25px Comic Sans MS"
                ct.fillStyle = "white"
                c.font = "30px Comic Sans MS"
                c.fillStyle = "white"
                if (bouton == 2.6 && phase == 1) {
                    speak = true
                    c.fillText("* ATT : 4                 DEF : 200", 50, 70)
                    c.fillText("A strange cat who wants to play with you.", 70, 110)
                }
                if (bouton == 2.6 && phase == 2) {
                    speak = true
                    c.fillText("* ATT : 4                 DEF : 0", 50, 70)
                    c.fillText("A strange cat who wanted to play with you.", 70, 110)
                    c.fillText("He is now waiting to be spared...", 70, 150)
                    c.fillStyle = "red"
                    c.fillText("He is vulnerable... go for it! :3", 70, 250)
                }
                if (bouton == 2.6 && phase == 3) {
                    speak = true
                    c.fillText("* ATT : 4                 DEF : ???", 50, 70)
                    c.fillText("A strange cat who no longer wants to play with you.", 70, 110)
                    c.fillText("He is now taking this fight way more seriously...", 70, 150)
                    c.fillStyle = "red"
                    c.fillText("Finally! A true challenge! :3", 70, 250)
                }
                if (bouton == 3 && bossvie.w > 10 && combat == false) {
                    speak = true
                    ct.fillText("That's looking good!", 10, 50)
                    ct.fillText("Mind sharing a bite?", 10, 80)
                    speak = false
                }
                if (bouton == 4.5 && phase == 1) {
                    bouton = 4.9
                    speak = true
                    ct.fillText("Don't be scared to attack me.", 10, 50)
                    ct.fillText("I still got a lot of health.", 10, 80)
                    ct.fillText("We are just here to have fun!", 10, 110)
                }
                if (bouton == 4.5 && phase == 3) {
                    bouton = 4.9
                    speak = true
                    ct.fillText("You're kidding right?", 10, 50)
                    ct.fillText("Is this some sort of joke to you?", 10, 80)
                    ct.fillText("You had your chance.", 10, 110)

                }
                if (bouton == 4.6) {
                    speak = true
                    ct.fillText("It was fun playing with you.", 10, 50)
                    ct.fillText("Don't hesitate to come ", 10, 80)
                    ct.fillText("for a second round!", 10, 110)
                }

                if (dialogue == 0 && bouton == 0 && bossvie.w > 10) {
                    speak = true
                    c.fillText("* A strange looking cat is blocking your path.", 50, 70)
                }
                if (dialogue == 1 && bossvie.w > 10 && bouton == 1) {
                    dialogue += 1
                    speak = true
                    ct.fillText("You came here to play huh?", 10, 50)
                    if (degat == 10) {
                        ct.fillText("Did you really need baby mode though?", 10, 80)
                    } else if (degat == 25) {
                        ct.fillText("Are you sure you can play on hard?", 10, 80)
                    }
                }
                if (dialogue == 2 && bouton == 0 && bossvie.w > 10) {
                    speak = true
                    c.fillText("* You did came here to play.", 50, 70)
                    c.fillText("Or are you expecting more from this?", 70, 110)
                }
                if (dialogue == 3 && bossvie.w > 10 && bouton == 1) {
                    dialogue += 1
                    speak = true
                    ct.fillText("Sure, I'll play.", 10, 50)
                    ct.fillText("It's not like I have something", 10, 80)
                    ct.fillText("else to do anyway.", 10, 110)
                }
                if (dialogue == 4 && bouton == 0 && bossvie.w > 10) {
                    speak = true
                    c.fillText("* Just play.", 50, 70)
                }
                if (dialogue == 5 && bossvie.w > 10 && bouton == 1) {
                    dialogue += 1
                    speak = true
                    ct.fillText("Don't be scared about dying.", 10, 50)
                    ct.fillText("You'll just restart at the beginning.", 10, 80)
                    ct.fillText("I can't say the same for me though.", 10, 110)
                }
                if (dialogue == 6 && bouton == 0 && bossvie.w > 10) {
                    speak = true
                    c.fillText("* You feel that he is hidding something from you.", 50, 70)
                }
                if (dialogue == 7 && bossvie.w > 10 && bouton == 1) {
                    dialogue += 1
                    speak = true
                    ct.fillText("We wouldn't want to", 10, 50)
                    ct.fillText("truly hurt each other...", 10, 80)
                    ct.fillText("Right?", 10, 110)
                }
                if (dialogue == 8 && bouton == 0 && bossvie.w > 10) {
                    speak = true
                    c.fillText("* Right...?", 50, 70)
                }
                if (dialogue == 9 && bossvie.w > 10 && bouton == 1) {
                    dialogue += 1
                    speak = true
                    ct.fillText("Anyway,", 10, 50)
                    ct.fillText("doesn't this game looks", 10, 80)
                    ct.fillText("familiar to you?", 10, 110)
                }
                if (dialogue == 10 && bouton == 0 && bossvie.w > 10) {
                    speak = true
                    c.fillText("* You start to question the creativity of the developer.", 50, 70)
                }
                if (dialogue == 11 && bossvie.w > 10 && bouton == 1) {
                    dialogue += 1
                    speak = true
                    ct.fillText("Almost as if the brilliant", 10, 50)
                    ct.fillText("and beautiful developer behind", 10, 80)
                    ct.fillText("this masterpiece was inspired", 10, 110)
                    ct.fillText("by another game.", 10, 140)
                }
                if (dialogue == 12 && bouton == 0 && bossvie.w > 10 || dialogue == 15 && bouton == 0 && bossvie.w > 10 || dialogue == 18 && bouton == 0 && bossvie.w > 10) {
                    speak = true
                    c.fillText("* Keep having fun.", 50, 70)
                }
                if (dialogue == 13 && bossvie.w > 10 && bouton == 1) {
                    dialogue += 1
                    speak = true
                    ct.fillText("If that's the case,", 10, 50)
                    ct.fillText("I bet this game is superior.", 10, 80)
                }
                if (dialogue == 14 && bouton == 0 && bossvie.w > 10) {
                    speak = true
                    c.fillText("* A ton of game better than this one cross your mind.", 50, 70)
                }
                if (dialogue == 16 && bossvie.w > 10 && bouton == 1) {
                    dialogue += 1
                    speak = true
                    ct.fillText("Still alive I see.", 10, 50)
                    ct.fillText("You are really good.", 10, 80)
                }
                if (dialogue == 17 && bouton == 0 && bossvie.w > 10) {
                    speak = true
                    c.fillText("* You feel your skills at the end of your fingers.", 50, 70)
                }
                if (dialogue == 19 && bossvie.w > 10 && bouton == 1) {
                    dialogue += 1
                    speak = true
                    ct.fillText("Is this your first time", 10, 50)
                    ct.fillText("coming this far or...", 10, 80)
                    ct.fillText("am I repeating myself?", 10, 110)
                }
                if (dialogue == 20 && bouton == 0 && bossvie.w > 10) {
                    speak = true
                    c.fillText("* Is he repeating himself?", 50, 70)
                    c.fillText("How could he know?", 70, 110)
                }
                if (dialogue > 20 && bouton == 0 && bossvie.w > 10) {
                    speak = true
                    c.fillText("* You can feel the game coming to an end...?", 50, 70)
                }
                if (dialogue == 25 && bossvie.w > 10 && bouton == 1) {
                    dialogue += 1
                    speak = true
                    ct.fillText("You're kinda slow arean't you?", 10, 50)
                    ct.fillText("Try to stop the bar in the", 10, 80)
                    ct.fillText("middle to deal more damage...", 10, 110)
                }
                if (phase == 2 && bouton == 0 && bossvie.w == 10) {
                    speak = true
                    c.fillText("* You considere to spare him and go play something better...", 50, 70)
                    c.fillStyle = "red"
                    c.fillText("But why not finishing the job first? :)", 70, 110)
                }

            } else if (menu == 4) {
                c.fillStyle = "red"
                c.fillRect(400, 300, 100, 20)
                c.fillStyle = healthbar.color
                c.fillRect(healthbar.x, healthbar.y, healthbar.w, healthbar.h)
                c.font = "25px Comic Sans MS"
                c.textAlign = "left"
                c.fillStyle = "white"
                c.fillText(healthbar.w / 5 + "/20", 550, 315)
                c.fillText("Use the arrow keys to move, enter to select", 300, 250)
                c.fillText("and SHIFT TO GO BACK.", 300, 275)
                c.fillText("This is your health bar.", 300, 350)
                c.fillText("If it becomes all red you're dead.", 300, 375)
                c.fillText("Use items to heal.", 300, 400)
                c.fillText("Red bars will hurt you.", 300, 50)
                c.fillText("Orange bars will hurt you if you're not moving.", 300, 75)
                c.fillText("Blue bars will hurt you if you're moving.", 300, 100)
                c.fillText("After being hit, you become invincible for the 2 next seconds.", 300, 125)
                c.fillStyle = "red"
                c.fillText("When your heart is red, you can move in any direction.", 300, 500)
                c.fillStyle = "blue"
                c.fillText("When your heart is blue, you are affected by gravity.", 300, 525)
                c.fillStyle = "green"
                c.fillText("When your heart is green, you control a shield", 300, 550)
                c.fillText("around you to stop the bullets.", 300, 575)


                for (i = 0; i < sacb.length; i++) {
                    sacb[i].draw()
                }

                for (i = 0; i < saco.length; i++) {
                    saco[i].draw()
                }

                for (i = 0; i < sac.length; i++) {
                    sac[i].draw()
                }
                c.drawImage(item, 750, 300, 200, 75)
                c.drawImage(coeur, joueur.x, joueur.y, joueur.w, joueur.h)
            }
        }

        //définit les collisions
        function collision(a, b) {
            if (a.x + a.w > b.x &&
                a.x < b.x + b.w &&
                a.y < b.y + b.h &&
                a.y + a.h > b.y) {
                return (true)
            }

        }

//tout ce qui se passe sur le clavier
        document.addEventListener("keydown", function (e) {
            keyDown[e.keyCode] = true

        })

        document.addEventListener("keyup", function (e) {
            delete keyDown[e.keyCode]
        })


        function clavier() {
//menu
            if (menu == 0) {
                if (37 in keyDown && clicked == false && joueur.x != 50) {
                    clicked = true
                    joueur.x -= 320
                    setTimeout(clicks, 200)
                }
                if (39 in keyDown && clicked == false && joueur.x != 690) {
                    clicked = true
                    joueur.x += 320
                    setTimeout(clicks, 200)
                }
                if (13 in keyDown && clicked == false) {
                    clicked = true
                    sclick.play()
                    if (joueur.x == 50) {
                        menu = 1
                    }
                    if (joueur.x == 370) {
                        canvas.style.border = "10px white solid"
                        document.getElementById("container0").style.display = "none"
                        canvas.height = 600
                        menu = 4
                        joueur.x = canvas.width / 2
                        joueur.y = canvas.height / 2
                    }
                    if (joueur.x == 690) {
                    }
                    setTimeout(clicks, 200)
                }
            } else if (menu == 4) {
                if (37 in keyDown && joueur.x > 0) {
                    joueur.x -= joueur.speed
                }
                if (39 in keyDown && joueur.x < canvas.width - joueur.w) {
                    joueur.x += joueur.speed
                }
                if (38 in keyDown && joueur.y > 0) {
                    joueur.y -= joueur.speed
                }
                if (40 in keyDown && joueur.y < canvas.height - joueur.h) {
                    joueur.y += joueur.speed
                }
                if (16 in keyDown && clicked == false) {
                    sac = []
                    sacb = []
                    saco = []
                    healthbar.w = 100
                    canvas.style.border = "0px white solid"
                    document.getElementById("container0").style.display = "block"
                    canvas.height = 400
                    menu = 0
                    joueur.x = 370
                    joueur.y = canvas.height / 2.3
                }
            } else if (menu == 1) {
                if (37 in keyDown && clicked == false && joueur.x != 50) {
                    clicked = true
                    joueur.x -= 310
                    setTimeout(clicks, 200)
                }
                if (39 in keyDown && clicked == false && joueur.x != 670) {
                    clicked = true
                    joueur.x += 310
                    setTimeout(clicks, 200)
                }
                if (13 in keyDown && clicked == false) {
                    clicked = true
                    sclick.play()
                    if (joueur.x == 50) {
                        items.noodles = 3
                        items.steroids = 2
                        items.candy = 7
                        items.cake = 4
                        items.pie = 3
                        menu = 2
                        degat = 10
                        joueur.x = 280
                    }
                    if (joueur.x == 360) {
                        items.noodles = 2
                        items.steroids = 2
                        items.candy = 6
                        items.cake = 3
                        items.pie = 3
                        menu = 2
                        degat = 20
                        joueur.x = 280
                    }
                    if (joueur.x == 670) {
                        items.noodles = 2
                        items.steroids = 1
                        items.candy = 5
                        items.cake = 3
                        items.pie = 2
                        music.src = "nutral.mp3"
                        joueur.x = 300
                        joueur.y = canvas.height - 47
                        menu = 3
                        degat = 25
                        document.getElementById("container0").style.display = "none"
                        document.getElementById("container").style.display = "block"
                        document.getElementById("text").style.display = "block"
                    }
                    setTimeout(clicks, 200)
                }
                if (16 in keyDown && clicked == false) {
                    menu = 0
                    if (joueur.x == 360) {
                        joueur.x = 370
                    }
                    if (joueur.x == 670) {
                        joueur.x = 690
                    }
                }
            } else if (menu == 2) {
                if (37 in keyDown && clicked == false && joueur.x != 280) {
                    clicked = true
                    joueur.x -= 240
                    setTimeout(clicks, 500)
                }
                if (39 in keyDown && clicked == false && joueur.x != 520) {
                    clicked = true
                    joueur.x += 240
                    setTimeout(clicks, 200)
                }
                if (13 in keyDown && clicked == false) {
                    clicked = true
                    sclick.play()
                    if (joueur.x == 280) {
                        checkpoints = false
                    }
                    if (joueur.x == 520) {
                        checkpoints = true
                    }
                    music.src = "nutral.mp3"
                    menu = 3
                    document.getElementById("container0").style.display = "none"
                    document.getElementById("container").style.display = "block"
                    document.getElementById("text").style.display = "block"
                    joueur.x = 300
                    joueur.y = canvas.height - 47
                    setTimeout(clicks, 200)
                }
                if (16 in keyDown && clicked == false) {
                    clicked = true
                    menu = 1
                    joueur.x = 50
                    setTimeout(clicks, 200)
                }

            } else if (menu == 3) {
                //jeu commence
                //les différentes gravités
                if (38 in keyDown && combat == true && gravity == 0 && joueur.y + joueur.h <= boite.y + boite.h && joueur.y > 100 && jump == true) {
                    joueur.y -= joueur.velocity
                    joueur.velocity = joueur.velocity * 0.99
                } else {
                    if (gravity == 0) {
                        if (jump == true) {
                            joueur.velocity = 0.75
                        }
                        jump = false
                    }
                }
                if (joueur.y + joueur.h >= boite.y + boite.h && combat == true && gravity == 0) {
                    jump = true
                    joueur.y = boite.y + boite.h - joueur.h
                    joueur.velocity = 7.5
                }
                if (gravity == 0 && jump == false && combat == true) {
                    joueur.y += joueur.velocity
                    joueur.velocity = joueur.velocity * 1.07
                }

                if (40 in keyDown && combat == true && gravity == 1 && joueur.y >= boite.y && joueur.y + joueur.h < 190 && jump == true) {
                    joueur.y += joueur.velocity
                    joueur.velocity = joueur.velocity * 0.99
                } else {
                    if (gravity == 1) {
                        if (jump == true) {
                            joueur.velocity = 0.75
                        }
                        jump = false
                    }
                }
                if (joueur.y <= boite.y && combat == true && gravity == 1) {
                    jump = true
                    joueur.y = boite.y
                    joueur.velocity = 7.5
                }
                if (gravity == 1 && jump == false && combat == true) {
                    joueur.y -= joueur.velocity
                    joueur.velocity = joueur.velocity * 1.07
                }

                if (39 in keyDown && combat == true && gravity == 2 && joueur.x >= boite.x && joueur.x + joueur.w < boite.x + 230 && jump == true) {
                    joueur.x += joueur.velocity
                    joueur.velocity = joueur.velocity * 0.99
                } else {
                    if (gravity == 2) {
                        if (jump == true) {
                            joueur.velocity = 0.75
                        }
                        jump = false
                    }
                }
                if (joueur.x <= boite.x && combat == true && gravity == 2) {
                    jump = true
                    joueur.x = boite.x
                    joueur.velocity = 7.5
                }
                if (gravity == 2 && jump == false && combat == true) {
                    joueur.x -= joueur.velocity
                    joueur.velocity = joueur.velocity * 1.07
                }

                if (37 in keyDown && combat == true && gravity == 3 && joueur.x + joueur.w <= boite.x + boite.w && joueur.x > boite.x + 150 && jump == true) {
                    joueur.x -= joueur.velocity
                    joueur.velocity = joueur.velocity * 0.99
                } else {
                    if (gravity == 3) {
                        if (jump == true) {
                            joueur.velocity = 0.75
                        }
                        jump = false
                    }
                }
                if (joueur.x + joueur.w >= boite.x + boite.w && combat == true && gravity == 3) {
                    jump = true
                    joueur.x = boite.x + boite.w - joueur.w
                    joueur.velocity = 7.5
                }
                if (gravity == 3 && jump == false && combat == true) {
                    joueur.x += joueur.velocity
                    joueur.velocity = joueur.velocity * 1.07
                }

                if (gravity == 4) {
                    if (37 in keyDown) {
                        shield.x = joueur.x - 30
                        shield.y = joueur.y - 20
                        shield.w = 10
                        shield.h = 60
                    }
                    if (39 in keyDown) {
                        shield.x = joueur.x + 40
                        shield.y = joueur.y - 20
                        shield.w = 10
                        shield.h = 60
                    }
                    if (38 in keyDown) {
                        shield.x = joueur.x - 20
                        shield.y = joueur.y - 30
                        shield.w = 60
                        shield.h = 10
                    }
                    if (40 in keyDown) {
                        shield.x = joueur.x - 20
                        shield.y = joueur.y + 40
                        shield.w = 60
                        shield.h = 10
                    }
                }

                if (37 in keyDown && joueur.x > boite.x && combat == true && gravity < 2) {
                    joueur.x -= joueur.speed
                }
                if (39 in keyDown && joueur.x < boite.x + boite.w - joueur.w && combat == true && gravity < 2) {
                    joueur.x += joueur.speed
                }
                if (38 in keyDown && joueur.y > boite.y && combat == true && gravity == -1 || 38 in keyDown && joueur.y > boite.y && combat == true && gravity > 1 && gravity != 4) {
                    joueur.y -= joueur.speed
                }
                if (40 in keyDown && joueur.y < boite.h + boite.y - joueur.h && combat == true && gravity == -1 || 40 in keyDown && joueur.y < boite.h + boite.y - joueur.h && combat == true && gravity > 1 && gravity != 4) {
                    joueur.y += joueur.speed
                }

                if (37 in keyDown && clicked == false && bouton == 0 && combat == false) {
                    clicked = true
                    if (joueur.x == 50) {
                        joueur.x = 800
                    } else {
                        joueur.x -= 250
                    }
                    setTimeout(clicks, 200)
                }
                if (39 in keyDown && clicked == false && bouton == 0 && combat == false) {
                    clicked = true
                    if (joueur.x == 800) {
                        joueur.x = 50
                    } else {
                        joueur.x += 250
                    }
                    setTimeout(clicks, 200)
                }

                if (37 in keyDown && clicked == false && bouton == 3 && combat == false) {
                    clicked = true
                    if (joueur.x == 49) {
                        joueur.x = 849
                    } else {
                        joueur.x -= 200
                    }
                    setTimeout(clicks, 200)
                }
                if (39 in keyDown && clicked == false && bouton == 3 && combat == false) {
                    clicked = true
                    if (joueur.x == 849) {
                        joueur.x = 49
                    } else {
                        joueur.x += 200
                    }
                    setTimeout(clicks, 200)
                }

                if (13 in keyDown && joueur.y != 50 && combat == false && healthbar.w > 0 && clicked == false) {
                    if (joueur.x == 50) {
                        bouton = 1
                    }
                    if (joueur.x == 300) {
                        bouton = 2
                    }
                    if (joueur.x == 550) {
                        bouton = 3
                    }
                    if (joueur.x == 800) {
                        bouton = 4
                    }
                    joueur.y = 49
                    joueur.x = 49
                    setTimeout(clickss, 200)
                }
                if (16 in keyDown && attacking == false && combat == false && bouton != 2.6) {
                    if (bouton == 1) {
                        joueur.x = 50
                    }
                    if (bouton == 2 || bouton == 2.5) {
                        joueur.x = 300
                    }
                    if (bouton == 3 || bouton == 3.5) {
                        joueur.x = 550
                    }
                    if (bouton == 4) {
                        joueur.x = 800
                    }
                    joueur.y = canvas.height - 47
                    bouton = 0
                }

                if (13 in keyDown && speak == true && clicked == false && combat == true) {
                    ct.clearRect(0, 0, canvast.width, canvast.height)
                    setTimeout(function () { speak = false }, 1000)
                    if (bouton == 4.5) {
                        bouton = 4.1
                    }
                }

                if (13 in keyDown && joueur.y == 50 && combat == false && clicked == false) {
                    clicked = true
                    speak = false
                    if (bouton == 1 && attacking == false && attbar.x < 100) {

                        attacking = true
                        joueur.x = -100
                        attbar.x = 0
                    } else if (attacking == true && attbar.x > 100 && joueur.x < 0) {
                        attackingsound.play()
                        attbar.speed = 0
                        joueur.y = boite.y + boite.h / 2 - joueur.h / 2
                        joueur.x = boite.x + boite.w / 2 - joueur.w / 2
                        if (phase == 1) {
                            document.getElementById("container").style.display = "none"
                            document.getElementById("container3").style.display = "block"
                        } else if (phase == 3 && attack < 16) {
                            document.getElementById("container2").style.display = "none"
                            document.getElementById("container10").style.display = "block"
                        } else if (phase == 3 && attack > 16) {
                        }
                        setTimeout(attacked, 600)
                    }
                    if (bouton == 2) {
                        bouton = 2.5
                    } else if (bouton == 2.5) {
                        bouton = 2.6
                        joueur.x = -100
                    } else if (bouton == 2.6) {
                        bouton = 2.7
                        attacked()
                    }
                    if (bouton == 3) {
                        if (joueur.x == 49 && items.noodles != 0) {
                            items.noodles -= 1
                            items.nood += 2
                            healthbar.w += 10
                            attacked()
                        } else if (joueur.x == 249 && items.steroids != 0) {
                            items.steroids -= 1
                            items.ster += 2
                            healthbar.w -= 25
                            attacked()
                        } else if (joueur.x == 449 && items.candy != 0) {
                            items.candy -= 1
                            healthbar.w += 25
                            attacked()
                        } else if (joueur.x == 649 && items.cake != 0) {
                            items.cake -= 1
                            healthbar.w += 50
                            attacked()
                        } else if (joueur.x == 849 && items.pie != 0) {
                            items.pie -= 1
                            healthbar.w += 100
                            attacked()
                        }

                    }
                    if (bouton == 4 && phase != 2) {
                        bouton = 4.5
                        joueur.y = boite.y + boite.h / 2 - joueur.h / 2
                        joueur.x = boite.x + boite.w / 2 - joueur.w / 2
                        attacked()
                    } else if (bouton == 4 && phase == 2) {
                        bouton = 4.6
                    } else if (bouton == 4.6) {
                        music.src = "menumusic.mp3"
                        bouton = 4.7
                        document.getElementById("container").style.display = "none"
                        document.getElementById("text").style.display = "none"
                        document.getElementById("monCanvas").style.display = "none"
                        document.getElementById("vieCanvas").style.display = "none"
                        document.getElementById("container12").style.display = "block"
                    } else if (bouton == 4.7) {
                        menu = 0
                        dialogue = 0
                        phase = 1
                        lastatt = -1
                        speak = false
                        checkpoints = false
                        attack = -1
                        joueur.x = 50
                        joueur.y = canvas.height / 2.3
                        bouton = 0
                        bossvie.w = 200
                        healthbar.w = 100
                        items.nood = 0
                        items.ster = 0
                        document.getElementById("vieCanvas").style.display = "block"
                        document.getElementById("container0").style.display = "block"
                        document.getElementById("monCanvas").style.display = "block"
                        document.getElementById("container12").style.display = "none"
                    }
                    setTimeout(clicks, 200)
                }
                //miss
                if (attacking == true && attbar.x > 1000 && joueur.x < 0) {
                    bouton = 1.1
                    attbar.speed = 0
                    joueur.y = boite.y + boite.h / 2 - joueur.h / 2
                    joueur.x = boite.x + boite.w / 2 - joueur.w / 2
                    if (phase < 3) {
                        document.getElementById("container").style.display = "none"
                        document.getElementById("container4").style.display = "block"
                    } else if (phase == 3 && attack < 16) {
                        document.getElementById("container2").style.display = "none"
                        document.getElementById("container11").style.display = "block"
                    }
                    setTimeout(attacked, 600)
                }

                //debug
                /*if (32 in keyDown) {
                    phase = 3
                    document.getElementById("container").style.display = "none"
                    document.getElementById("container2").style.display = "block"
                }

                if (70 in keyDown && clicked == false) {
                    clicked = true
                    attack = 11
                    setTimeout(clicks, 200)
                }*/
            }
        }

        //wasd
        function clavierwasd() {
                
//menu
            if (menu == 0) {
                if (65 in keyDown && clicked == false && joueur.x != 50) {
                    clicked = true
                    joueur.x -= 320
                    setTimeout(clicks, 200)
                }
                if (68 in keyDown && clicked == false && joueur.x != 690) {
                    clicked = true
                    joueur.x += 320
                    setTimeout(clicks, 200)
                }
                if (13 in keyDown && clicked == false) {
                    clicked = true
                    sclick.play()
                    if (joueur.x == 50) {
                        menu = 1
                    }
                    if (joueur.x == 370) {
                        canvas.style.border = "10px white solid"
                        document.getElementById("container0").style.display = "none"
                        canvas.height = 600
                        menu = 4
                        joueur.x = canvas.width / 2
                        joueur.y = canvas.height / 2
                    }
                    if (joueur.x == 690) {
                    }
                    setTimeout(clicks, 200)
                }
            } else if (menu == 4) {
                if (65 in keyDown && joueur.x > 0) {
                    joueur.x -= joueur.speed
                }
                if (68 in keyDown && joueur.x < canvas.width - joueur.w) {
                    joueur.x += joueur.speed
                }
                if (87 in keyDown && joueur.y > 0) {
                    joueur.y -= joueur.speed
                }
                if (83 in keyDown && joueur.y < canvas.height - joueur.h) {
                    joueur.y += joueur.speed
                }
                if (16 in keyDown && clicked == false) {
                    sac = []
                    sacb = []
                    saco = []
                    healthbar.w = 100
                    canvas.style.border = "0px white solid"
                    document.getElementById("container0").style.display = "block"
                    canvas.height = 400
                    menu = 0
                    joueur.x = 370
                    joueur.y = canvas.height / 2.3
                }
            } else if (menu == 1) {
                if (65 in keyDown && clicked == false && joueur.x != 50) {
                    clicked = true
                    joueur.x -= 310
                    setTimeout(clicks, 200)
                }
                if (68 in keyDown && clicked == false && joueur.x != 670) {
                    clicked = true
                    joueur.x += 310
                    setTimeout(clicks, 200)
                }
                if (13 in keyDown && clicked == false) {
                    clicked = true
                    sclick.play()
                    if (joueur.x == 50) {
                        items.noodles = 3
                        items.steroids = 2
                        items.candy = 7
                        items.cake = 4
                        items.pie = 3
                        menu = 2
                        degat = 10
                        joueur.x = 280
                    }
                    if (joueur.x == 360) {
                        items.noodles = 2
                        items.steroids = 2
                        items.candy = 6
                        items.cake = 3
                        items.pie = 3
                        menu = 2
                        degat = 20
                        joueur.x = 280
                    }
                    if (joueur.x == 670) {
                        items.noodles = 2
                        items.steroids = 1
                        items.candy = 5
                        items.cake = 3
                        items.pie = 2
                        music.src = "nutral.mp3"
                        joueur.x = 300
                        joueur.y = canvas.height - 47
                        menu = 3
                        degat = 25
                        document.getElementById("container0").style.display = "none"
                        document.getElementById("container").style.display = "block"
                        document.getElementById("text").style.display = "block"
                    }
                    setTimeout(clicks, 200)
                }
                if (16 in keyDown && clicked == false) {
                    menu = 0
                    if (joueur.x == 360) {
                        joueur.x = 370
                    }
                    if (joueur.x == 670) {
                        joueur.x = 690
                    }
                }
            } else if (menu == 2) {
                if (65 in keyDown && clicked == false && joueur.x != 280) {
                    clicked = true
                    joueur.x -= 240
                    setTimeout(clicks, 500)
                }
                if (68 in keyDown && clicked == false && joueur.x != 520) {
                    clicked = true
                    joueur.x += 240
                    setTimeout(clicks, 200)
                }
                if (13 in keyDown && clicked == false) {
                    clicked = true
                    sclick.play()
                    if (joueur.x == 280) {
                        checkpoints = false
                    }
                    if (joueur.x == 520) {
                        checkpoints = true
                    }
                    music.src = "nutral.mp3"
                    menu = 3
                    document.getElementById("container0").style.display = "none"
                    document.getElementById("container").style.display = "block"
                    document.getElementById("text").style.display = "block"
                    joueur.x = 300
                    joueur.y = canvas.height - 47
                    setTimeout(clicks, 200)
                }
                if (16 in keyDown && clicked == false) {
                    clicked = true
                    menu = 1
                    joueur.x = 50
                    setTimeout(clicks, 200)
                }

            } else if (menu == 3) {
                //jeu commence
                //les différentes gravités
                if (87 in keyDown && combat == true && gravity == 0 && joueur.y + joueur.h <= boite.y + boite.h && joueur.y > 100 && jump == true) {
                    joueur.y -= joueur.velocity
                    joueur.velocity = joueur.velocity * 0.99
                } else {
                    if (gravity == 0) {
                        if (jump == true) {
                            joueur.velocity = 0.75
                        }
                        jump = false
                    }
                }
                if (joueur.y + joueur.h >= boite.y + boite.h && combat == true && gravity == 0) {
                    jump = true
                    joueur.y = boite.y + boite.h - joueur.h
                    joueur.velocity = 7.5
                }
                if (gravity == 0 && jump == false && combat == true) {
                    joueur.y += joueur.velocity
                    joueur.velocity = joueur.velocity * 1.07
                }

                if (83 in keyDown && combat == true && gravity == 1 && joueur.y >= boite.y && joueur.y + joueur.h < 190 && jump == true) {
                    joueur.y += joueur.velocity
                    joueur.velocity = joueur.velocity * 0.99
                } else {
                    if (gravity == 1) {
                        if (jump == true) {
                            joueur.velocity = 0.75
                        }
                        jump = false
                    }
                }
                if (joueur.y <= boite.y && combat == true && gravity == 1) {
                    jump = true
                    joueur.y = boite.y
                    joueur.velocity = 7.5
                }
                if (gravity == 1 && jump == false && combat == true) {
                    joueur.y -= joueur.velocity
                    joueur.velocity = joueur.velocity * 1.07
                }

                if (68 in keyDown && combat == true && gravity == 2 && joueur.x >= boite.x && joueur.x + joueur.w < boite.x + 230 && jump == true) {
                    joueur.x += joueur.velocity
                    joueur.velocity = joueur.velocity * 0.99
                } else {
                    if (gravity == 2) {
                        if (jump == true) {
                            joueur.velocity = 0.75
                        }
                        jump = false
                    }
                }
                if (joueur.x <= boite.x && combat == true && gravity == 2) {
                    jump = true
                    joueur.x = boite.x
                    joueur.velocity = 7.5
                }
                if (gravity == 2 && jump == false && combat == true) {
                    joueur.x -= joueur.velocity
                    joueur.velocity = joueur.velocity * 1.07
                }

                if (65 in keyDown && combat == true && gravity == 3 && joueur.x + joueur.w <= boite.x + boite.w && joueur.x > boite.x + 150 && jump == true) {
                    joueur.x -= joueur.velocity
                    joueur.velocity = joueur.velocity * 0.99
                } else {
                    if (gravity == 3) {
                        if (jump == true) {
                            joueur.velocity = 0.75
                        }
                        jump = false
                    }
                }
                if (joueur.x + joueur.w >= boite.x + boite.w && combat == true && gravity == 3) {
                    jump = true
                    joueur.x = boite.x + boite.w - joueur.w
                    joueur.velocity = 7.5
                }
                if (gravity == 3 && jump == false && combat == true) {
                    joueur.x += joueur.velocity
                    joueur.velocity = joueur.velocity * 1.07
                }

                if (gravity == 4) {
                    if (65 in keyDown) {
                        shield.x = joueur.x - 30
                        shield.y = joueur.y - 20
                        shield.w = 10
                        shield.h = 60
                    }
                    if (68 in keyDown) {
                        shield.x = joueur.x + 40
                        shield.y = joueur.y - 20
                        shield.w = 10
                        shield.h = 60
                    }
                    if (87 in keyDown) {
                        shield.x = joueur.x - 20
                        shield.y = joueur.y - 30
                        shield.w = 60
                        shield.h = 10
                    }
                    if (83 in keyDown) {
                        shield.x = joueur.x - 20
                        shield.y = joueur.y + 40
                        shield.w = 60
                        shield.h = 10
                    }
                }

                if (65 in keyDown && joueur.x > boite.x && combat == true && gravity < 2) {
                    joueur.x -= joueur.speed
                }
                if (68 in keyDown && joueur.x < boite.x + boite.w - joueur.w && combat == true && gravity < 2) {
                    joueur.x += joueur.speed
                }
                if (87 in keyDown && joueur.y > boite.y && combat == true && gravity == -1 || 87 in keyDown && joueur.y > boite.y && combat == true && gravity > 1 && gravity != 4) {
                    joueur.y -= joueur.speed
                }
                if (83 in keyDown && joueur.y < boite.h + boite.y - joueur.h && combat == true && gravity == -1 || 83 in keyDown && joueur.y < boite.h + boite.y - joueur.h && combat == true && gravity > 1 && gravity != 4) {
                    joueur.y += joueur.speed
                }

                if (65 in keyDown && clicked == false && bouton == 0 && combat == false) {
                    clicked = true
                    if (joueur.x == 50) {
                        joueur.x = 800
                    } else {
                        joueur.x -= 250
                    }
                    setTimeout(clicks, 200)
                }
                if (68 in keyDown && clicked == false && bouton == 0 && combat == false) {
                    clicked = true
                    if (joueur.x == 800) {
                        joueur.x = 50
                    } else {
                        joueur.x += 250
                    }
                    setTimeout(clicks, 200)
                }

                if (65 in keyDown && clicked == false && bouton == 3 && combat == false) {
                    clicked = true
                    if (joueur.x == 49) {
                        joueur.x = 849
                    } else {
                        joueur.x -= 200
                    }
                    setTimeout(clicks, 200)
                }
                if (68 in keyDown && clicked == false && bouton == 3 && combat == false) {
                    clicked = true
                    if (joueur.x == 849) {
                        joueur.x = 49
                    } else {
                        joueur.x += 200
                    }
                    setTimeout(clicks, 200)
                }

                if (13 in keyDown && joueur.y != 50 && combat == false && healthbar.w > 0 && clicked == false) {
                    if (joueur.x == 50) {
                        bouton = 1
                    }
                    if (joueur.x == 300) {
                        bouton = 2
                    }
                    if (joueur.x == 550) {
                        bouton = 3
                    }
                    if (joueur.x == 800) {
                        bouton = 4
                    }
                    joueur.y = 49
                    joueur.x = 49
                    setTimeout(clickss, 200)
                }
                if (16 in keyDown && attacking == false && combat == false && bouton != 2.6) {
                    if (bouton == 1) {
                        joueur.x = 50
                    }
                    if (bouton == 2 || bouton == 2.5) {
                        joueur.x = 300
                    }
                    if (bouton == 3 || bouton == 3.5) {
                        joueur.x = 550
                    }
                    if (bouton == 4) {
                        joueur.x = 800
                    }
                    joueur.y = canvas.height - 47
                    bouton = 0
                }

                if (13 in keyDown && speak == true && clicked == false && combat == true) {
                    ct.clearRect(0, 0, canvast.width, canvast.height)
                    setTimeout(function () { speak = false }, 1000)
                    if (bouton == 4.5) {
                        bouton = 4.1
                    }
                }

                if (13 in keyDown && joueur.y == 50 && combat == false && clicked == false) {
                    clicked = true
                    speak = false
                    if (bouton == 1 && attacking == false && attbar.x < 100) {

                        attacking = true
                        joueur.x = -100
                        attbar.x = 0
                    } else if (attacking == true && attbar.x > 100 && joueur.x < 0) {
                        attackingsound.play()
                        attbar.speed = 0
                        joueur.y = boite.y + boite.h / 2 - joueur.h / 2
                        joueur.x = boite.x + boite.w / 2 - joueur.w / 2
                        if (phase == 1) {
                            document.getElementById("container").style.display = "none"
                            document.getElementById("container3").style.display = "block"
                        } else if (phase == 3 && attack < 16) {
                            document.getElementById("container2").style.display = "none"
                            document.getElementById("container10").style.display = "block"
                        } else if (phase == 3 && attack > 16) {
                        }
                        setTimeout(attacked, 600)
                    }
                    if (bouton == 2) {
                        bouton = 2.5
                    } else if (bouton == 2.5) {
                        bouton = 2.6
                        joueur.x = -100
                    } else if (bouton == 2.6) {
                        bouton = 2.7
                        attacked()
                    }
                    if (bouton == 3) {
                        if (joueur.x == 49 && items.noodles != 0) {
                            items.noodles -= 1
                            items.nood += 2
                            healthbar.w += 10
                            attacked()
                        } else if (joueur.x == 249 && items.steroids != 0) {
                            items.steroids -= 1
                            items.ster += 2
                            healthbar.w -= 25
                            attacked()
                        } else if (joueur.x == 449 && items.candy != 0) {
                            items.candy -= 1
                            healthbar.w += 25
                            attacked()
                        } else if (joueur.x == 649 && items.cake != 0) {
                            items.cake -= 1
                            healthbar.w += 50
                            attacked()
                        } else if (joueur.x == 849 && items.pie != 0) {
                            items.pie -= 1
                            healthbar.w += 100
                            attacked()
                        }

                    }
                    if (bouton == 4 && phase != 2) {
                        bouton = 4.5
                        joueur.y = boite.y + boite.h / 2 - joueur.h / 2
                        joueur.x = boite.x + boite.w / 2 - joueur.w / 2
                        attacked()
                    } else if (bouton == 4 && phase == 2) {
                        bouton = 4.6
                    } else if (bouton == 4.6) {
                        music.src = "menumusic.mp3"
                        bouton = 4.7
                        document.getElementById("container").style.display = "none"
                        document.getElementById("text").style.display = "none"
                        document.getElementById("monCanvas").style.display = "none"
                        document.getElementById("vieCanvas").style.display = "none"
                        document.getElementById("container12").style.display = "block"
                    } else if (bouton == 4.7) {
                        menu = 0
                        dialogue = 0
                        phase = 1
                        lastatt = -1
                        speak = false
                        checkpoints = false
                        attack = -1
                        joueur.x = 50
                        joueur.y = canvas.height / 2.3
                        bouton = 0
                        bossvie.w = 200
                        healthbar.w = 100
                        items.nood = 0
                        items.ster = 0
                        document.getElementById("vieCanvas").style.display = "block"
                        document.getElementById("container0").style.display = "block"
                        document.getElementById("monCanvas").style.display = "block"
                        document.getElementById("container12").style.display = "none"
                    }
                    setTimeout(clicks, 200)
                }
                //miss
                if (attacking == true && attbar.x > 1000 && joueur.x < 0) {
                    bouton = 1.1
                    attbar.speed = 0
                    joueur.y = boite.y + boite.h / 2 - joueur.h / 2
                    joueur.x = boite.x + boite.w / 2 - joueur.w / 2
                    if (phase < 3) {
                        document.getElementById("container").style.display = "none"
                        document.getElementById("container4").style.display = "block"
                    } else if (phase == 3 && attack < 16) {
                        document.getElementById("container2").style.display = "none"
                        document.getElementById("container11").style.display = "block"
                    }
                    setTimeout(attacked, 600)
                }

                //debug
                /*if (32 in keyDown) {
                    phase = 3
                    document.getElementById("container").style.display = "none"
                    document.getElementById("container2").style.display = "block"
                }

                if (70 in keyDown && clicked == false) {
                    clicked = true
                    attack = 11
                    setTimeout(clicks, 200)
                }*/
            }
        }

        function clicks() {
            clicked = false
        }

        function clickss() {
            joueur.y = 50
        }

//mise en marche des attaques
        function attacked() {

            transition = true
            if (phase < 3) {
                document.getElementById("container").style.display = "block"
                document.getElementById("container3").style.display = "none"
                document.getElementById("container4").style.display = "none"
            } else if (phase == 3 && attack < 16) {
                document.getElementById("container2").style.display = "block"
                document.getElementById("container10").style.display = "none"
                document.getElementById("container11").style.display = "none"
            }

            if (phase < 3) {
                attack = Math.floor(Math.random() * 21)
                if (lastatt == attack) {
                    attack = Math.floor(Math.random() * 21)
                }
                lastatt = attack
            } else if (phase == 3 && bouton == 1 || phase == 3 && attack == -1) {
                attack += 1
            } else if (phase == 3 && bouton != 1 && attack == 1) {
                attack = 0
            } else if (phase == 3 && bouton != 1 && attack == 4) {
                attack = 3
            } else if (phase == 3 && bouton != 1 && attack == 11) {
                attack = 10
            } else if (phase == 3 && bouton != 1 && attack == 16) {
                attack = 15
            }
            if (phase < 3 && bouton == 1) {
                dialogue += 1
                if (attbar.x + attbar.w / 2 > 100 && attbar.x + attbar.w / 2 <= 320 || attbar.x + attbar.w / 2 > 680 && attbar.x + attbar.w / 2 <= 1000) {
                    damage = Math.floor(Math.random() * 6)
                } else if (attbar.x + attbar.w / 2 > 320 && attbar.x + attbar.w / 2 <= 450 || attbar.x + attbar.w / 2 > 550 && attbar.x + attbar.w / 2 <= 680) {
                    damage = 5 + Math.floor(Math.random() * 6)
                } else if (attbar.x + attbar.w / 2 > 450 && attbar.x + attbar.w / 2 <= 490 || attbar.x + attbar.w / 2 > 510 && attbar.x + attbar.w / 2 <= 550) {
                    damage = 10 + Math.floor(Math.random() * 6)
                } else if (attbar.x + attbar.w / 2 > 490 && attbar.x + attbar.w / 2 <= 510) {
                    damage = 15 + Math.floor(Math.random() * 6)
                }
            } else if (phase == 3) {
                damage = 0
                combat2 = true
                if (attack == 17 && bouton == 1) {
                    damage = 9
                    document.getElementById("container2").style.display = "none"
                    document.getElementById("container13").style.display = "block"
                    setTimeout(function () {
                        document.getElementById("container13").style.display = "none"
                        document.getElementById("container14").style.display = "block"
                    }, 2200)
                }
                if (attack == 18 && bouton == 1) {
                    combat2 = false
                    damage = 1000
                    document.getElementById("container14").style.display = "none"
                    document.getElementById("container15").style.display = "block"
                    setTimeout(function () {
                        document.getElementById("container15").style.display = "none"
                        document.getElementById("container16").style.display = "block"
                        combat2 = true
                    }, 3000)
                }
            } else if (bouton > 1) {
                damage = 0
            }

            if (items.nood > 0) {
                items.nood -= 1
            }
            if (items.ster > 0 && bouton == 1) {
                items.ster -= 1
                damage = damage * 2
            }
            bossvie.w -= damage
            attbar.x = -100
            attbar.speed = 10

            attacking = false
            combat = true


            joueur.y = boite.y + boite.h / 2 - joueur.h / 2
            joueur.x = boite.x + boite.w / 2 - joueur.w / 2

            if (phase == 1) {
                if (attack == 8 || attack == 11 || attack == 12) {
                    gravity = 0
                }
                if (attack == 14) {
                    gravity = 1
                }
                if (attack == 17 || attack == 18) {
                    gravity = 4
                }
            } else if (phase == 3) {
                if (attack == 0 || attack == 10 || attack == 12 || attack == 15) {
                    gravity = 0
                }
                if (attack == 8 || attack == 9) {
                    gravity = 4
                }
            }

            if (bossvie.w <= 10 && phase == 1) {
                bossvie.w = 10
                gravity = -1
            }

            if (bossvie.w <= 10 && phase == 2 && damage > 0) {
                document.getElementById("container").style.display = "none"
                document.getElementById("container8").style.display = "block"
                gravity = -1
            }

            setTimeout(function () {
                transition = false
                if (bossvie.w <= 10 && phase == 2 && damage > 0) {
                    bossvie.w = 10
                    end()
                }
                if (bossvie.w <= 10 && phase == 2 && damage == 0) {
                    bossvie.w = 10
                    returns()
                }
                if (bossvie.w <= 10 && phase == 1) {
                    end()
                }
            }, 1500)

        }

        //construit missiles
        function missiles(x, y, w, h, color, speed, dir, mode, spy) {
            this.x = x
            this.y = y
            this.w = w
            this.h = h
            this.color = color
            this.speed = speed
            this.dir = dir
            this.mode = mode
            this.spy = spy
            this.draw = function () {
                c.fillStyle = this.color

                //directions
                if (this.dir == 1 || this.dir == 0) {
                    c.fillRect(this.x += this.speed, this.y, this.w, this.h)
                } else if (this.dir == 2) {
                    c.fillRect(this.x -= this.speed, this.y, this.w, this.h)
                } else if (this.dir == 3) {
                    c.fillRect(this.x, this.y -= this.speed, this.w, this.h)
                } else if (this.dir == 4) {
                    c.fillRect(this.x, this.y += this.speed, this.w, this.h)
                } else if (this.dir == 5) {
                    c.fillRect(this.x += this.speed, this.y += this.speed, this.w, this.h)
                } else if (this.dir == 6) {
                    c.fillRect(this.x -= this.speed, this.y += this.speed, this.w, this.h)
                } else if (this.dir == 7) {
                    c.fillRect(this.x += this.speed, this.y -= this.speed, this.w, this.h)
                } else if (this.dir == 8) {
                    c.fillRect(this.x -= this.speed, this.y -= this.speed, this.w, this.h)
                }

//"flappy mode"
                if (this.mode == 1) {
                    if (this.dir == 1) {
                        sac.push(new missiles(this.x - 5, this.y + this.h + 55, this.w, boite.h - this.h - 55, this.color, this.speed, this.dir))
                    }
                    if (this.dir == 2) {
                        sac.push(new missiles(this.x + 5, this.y + this.h + 55, this.w, boite.h - this.h - 55, this.color, this.speed, this.dir))
                    }

                }

                //"pong mode"
                if (this.mode == 2) {
                    c.fillRect(this.x, this.y, this.w, this.h)

                    if (this.y < boite.y || this.y + this.h > boite.y + boite.h) {
                        this.speed = -this.speed
                    }

                    if (this.x < boite.x || this.x + this.w > boite.x + boite.w) {
                        this.spy = -this.spy
                    }

                    this.x += this.spy
                    this.y += this.speed

                }

                //accélération
                if (this.mode == 3) {

                    this.speed = this.speed * 1.05
                }

                //for one attack only lol
                if (this.mode == 4 && this.speed == 0) {
                    if (this.dir == 1 || this.dir == 0) {
                        this.x = -40
                        this.y = joueur.y
                        this.w = 40
                        this.h = 20
                    } else if (this.dir == 2) {
                        this.x = canvas.width
                        this.y = joueur.y
                        this.w = 40
                        this.h = 20
                    } else if (this.dir == 3) {
                        this.x = joueur.x
                        this.y = canvas.height
                        this.w = 20
                        this.h = 40
                    } else if (this.dir == 4) {
                        this.x = joueur.x
                        this.y = -40
                        this.w = 20
                        this.h = 40
                    }
                    this.speed = 2
                }

                //accélération+flappy mode
                if (this.mode == 13) {

                    if (this.dir == 1 && this.speed == 0.1) {
                        sac.push(new missiles(this.x, this.y + this.h + 55, this.w, boite.h - this.h - 55, this.color, this.speed, this.dir, 3))
                    }
                    if (this.dir == 2 && this.speed == 0.1) {
                        sac.push(new missiles(this.x, this.y + this.h + 55, this.w, boite.h - this.h - 55, this.color, this.speed, this.dir, 3))
                    }
                    this.speed = this.speed * 1.05
                }

            }


        }

//toutes les attaques
        setInterval(attack1, 1200)
        setInterval(attack2, 200)
        setInterval(attack3, 3000)
        setInterval(attack4, 800)
        setInterval(attack5, 600)

        function attack1() {
            if (menu == 4) {
                sac.push(new missiles(0, 0, 100, 10, "red", 4, 4))
                saco.push(new missiles(100, 0, 100, 10, "orange", 4, 4))
                sacb.push(new missiles(200, 0, 100, 10, "lightblue", 4, 4))
            }
            if (phase == 1 && transition == false && speak == false) {
                if (attack == 0) {
                    sac.push(new missiles(0, boite.y, 10, boite.h / 2, "red", 4, 1))
                    sac.push(new missiles(canvas.width, boite.y + boite.h / 2, 10, boite.h / 2, "red", 4, 2))
                    if (wait == false) {
                        wait = true
                        setTimeout(end, 7000)
                    }
                } else if (attack == 1) {
                    sac.push(new missiles(canvas.width, boite.y, 10, boite.h / 2, "red", 4, 2))
                    sac.push(new missiles(0, boite.y + boite.h / 2, 10, boite.h / 2, "red", 4, 1))
                    if (wait == false) {
                        wait = true
                        setTimeout(end, 7000)
                    }
                } else if (attack == 2) {
                    sac.push(new missiles(0, boite.y, 10, Math.random() * boite.h / 1.3, "red", 3, 1, 1))
                    if (wait == false) {
                        wait = true
                        setTimeout(end, 7000)
                    }
                } else if (attack == 3) {
                    sac.push(new missiles(canvas.width, boite.y, 10, Math.random() * boite.h / 1.3, "red", 3, 2, 1))
                    if (wait == false) {
                        wait = true
                        setTimeout(end, 7000)
                    }
                }
            }

            if (phase == 3 && transition == false && combat2 == true && speak == false) {
                if (attack == 0) {
                    sac.push(new missiles(0, boite.y, 10, boite.h / 2, "red", 3.5, 1))
                    sac.push(new missiles(canvas.width, boite.y + boite.h / 2, 10, boite.h / 2, "red", 3.5, 2))
                    if (wait == false) {
                        wait = true
                        setTimeout(function () {
                            attack += 0.5
                            setTimeout(function () {
                                gravity = 1
                                wait = false
                                attack += 0.5
                            }, 3000)
                        }, 7000)
                    }
                } else if (attack == 1) {
                    sac.push(new missiles(canvas.width, boite.y, 10, boite.h / 2, "red", 3.5, 2))
                    sac.push(new missiles(0, boite.y + boite.h / 2, 10, boite.h / 2, "red", 3.5, 1))
                    if (wait == false) {
                        wait = true
                        setTimeout(end, 7000)
                    }
                } else if (attack == 3) {
                    sac.push(new missiles(boite.x + Math.random() * (boite.w - 55), boite.y - 55, 55, 55, "red", 2, 4))
                    setTimeout(function () { attack = 4 }, 7500)
                } if (attack == 4) {
                    sac.push(new missiles(boite.x + Math.random() * (boite.w - 55), boite.y + boite.h + 55, 55, 55, "red", 2, 3))
                    if (wait == false) {
                        wait = true
                        setTimeout(end, 14000)
                    }
                } else if (attack == 5) {
                    gravity = Math.floor(Math.random() * 4)
                    if (gravity == 0) {
                        sac.push(new missiles(0, boite.y + boite.h - 50, 10, 50, "red", 8, 1))
                        sac.push(new missiles(canvas.width, boite.y + boite.h - 50, 10, 50, "red", 8, 2))
                    } else if (gravity == 1) {
                        sac.push(new missiles(0, boite.y, 10, 50, "red", 8, 1))
                        sac.push(new missiles(canvas.width, boite.y, 10, 50, "red", 8, 2))
                    } else if (gravity == 2) {
                        sac.push(new missiles(boite.x, -350, 50, 10, "red", 8, 4))
                        sac.push(new missiles(boite.x, canvas.height + 250, 50, 10, "red", 8, 3))
                    } else if (gravity == 3) {
                        sac.push(new missiles(boite.x + boite.w - 50, -350, 50, 10, "red", 8, 4))
                        sac.push(new missiles(boite.x + boite.w - 50, canvas.height + 250, 50, 10, "red", 8, 3))
                    }
                    if (wait == false) {
                        wait = true
                        setTimeout(end, 15000)
                    }
                } else if (attack == 8) {
                    sac.push(new missiles(joueur.x, canvas.height, 20, 40, "red", 0.75, 3))
                    if (wait == false) {
                        wait = true
                        setTimeout(end, 20000)
                    }
                } else if (attack == 15) {
                    sacb.push(new missiles(canvas.width, boite.y, 10, boite.h, "lightblue", 10, 2))
                    setTimeout(function () { sac.push(new missiles(canvas.width, boite.y + boite.h - 80, 10, 80, "red", 10, 2)) }, 500)
                    if (wait == false) {
                        wait = true
                        setTimeout(function () {
                            wait = false
                            attack = 16
                        }, 7000)
                    }
                } else if (attack == 16) {
                    sacb.push(new missiles(-150, boite.y, 10, boite.h, "lightblue", 7, 1))
                    saco.push(new missiles(0, boite.y, 10, boite.h, "orange", 7, 1))
                    if (wait == false) {
                        wait = true
                        setTimeout(end, 7000)
                    }

                } else if (attack == 17) {
                    end()
                } else if (attack == 20) {
                    gravity = 2
                    sac.push(new missiles(boite.x, canvas.height, 20, 10, "red", 6, 3))
                    sac.push(new missiles(boite.x + 100, canvas.height, boite.w - 100, 10, "red", 6, 3))
                    if (wait == false) {
                        wait = true
                        setTimeout(function () {
                            attack = 21
                            wait = false
                        }, 5000)
                    }
                } else if (attack == 21) {
                    gravity = 3
                    sac.push(new missiles(0, boite.y, 10, Math.random() * (boite.h - 55), "red", 7, 1, 1))
                    if (wait == false) {
                        wait = true
                        setTimeout(function () {
                            attack = 22
                            wait = false
                        }, 5000)
                    }
                } else if (attack == 22) {
                    attack = 23
                    sac.push(new missiles(canvas.width + 100, boite.y, 10, 110, "red", 5, 2, 1))
                    sac.push(new missiles(boite.x + boite.w - 150, canvas.height + 300, 150, 10, "red", 5, 3))
                } else if (attack == 23) {
                    if (wait == false) {
                        wait = true
                        setTimeout(function () {
                            gravity = 4
                            joueur.y = boite.y + boite.h / 2 - joueur.h / 2
                            joueur.x = boite.x + boite.w / 2 - joueur.w / 2
                            attack = 24
                            wait = false
                        }, 1300)
                    }

                } else if (attack == 26) {
                    gravity = Math.floor(Math.random() * 4)
                    if (gravity == 0) {
                        sac.push(new missiles(0, boite.y + boite.h - 70, 10, 70, "red", 8, 1))
                        sac.push(new missiles(canvas.width, boite.y + boite.h - 70, 10, 70, "red", 8, 2))
                    } else if (gravity == 1) {
                        sac.push(new missiles(0, boite.y, 10, 70, "red", 8, 1))
                        sac.push(new missiles(canvas.width, boite.y, 10, 70, "red", 8, 2))
                    } else if (gravity == 2) {
                        sac.push(new missiles(boite.x, -350, 70, 10, "red", 8, 4))
                        sac.push(new missiles(boite.x, canvas.height + 250, 70, 10, "red", 8, 3))
                    } else if (gravity == 3) {
                        sac.push(new missiles(boite.x + boite.w - 70, -350, 70, 10, "red", 8, 4))
                        sac.push(new missiles(boite.x + boite.w - 70, canvas.height + 250, 70, 10, "red", 8, 3))
                    }
                    if (wait == false) {
                        wait = true
                        setTimeout(function () {
                            gravity = 1
                            attack = 27
                            wait = false
                        }, 7000)
                    }
                } else if (attack == 27) {
                    setTimeout(function () {
                        gravity = -1
                        attack = 28
                        sac.push(new missiles(boite.x - 100, boite.y, 50, 25, "red", 0.5, 1, 3))
                        sac.push(new missiles(boite.x + boite.w + 100, boite.y, 50, 25, "red", 0.5, 2, 3))
                        setTimeout(function () {
                            sac.push(new missiles(boite.x - 100, boite.y + 30, 50, 25, "red", 0.5, 1, 3))
                            sac.push(new missiles(boite.x + boite.w + 100, boite.y + 30, 50, 25, "red", 0.5, 2, 3))
                            setTimeout(function () {
                                sac.push(new missiles(boite.x - 100, boite.y + 60, 50, 25, "red", 0.5, 1, 3))
                                sac.push(new missiles(boite.x + boite.w + 100, boite.y + 60, 50, 25, "red", 0.5, 2, 3))
                                setTimeout(function () {
                                    sac.push(new missiles(boite.x - 100, boite.y + 90, 50, 25, "red", 0.5, 1, 3))
                                    sac.push(new missiles(boite.x + boite.w + 100, boite.y + 90, 50, 25, "red", 0.5, 2, 3))
                                    setTimeout(function () {
                                        sac.push(new missiles(boite.x - 100, boite.y + 120, 50, 25, "red", 0.5, 1, 3))
                                        sac.push(new missiles(boite.x + boite.w + 100, boite.y + 120, 50, 25, "red", 0.5, 2, 3))
                                        setTimeout(function () {
                                            sac.push(new missiles(boite.x - 100, boite.y + 150, 50, 25, "red", 0.5, 1, 3))
                                            sac.push(new missiles(boite.x + boite.w + 100, boite.y + 150, 50, 25, "red", 0.5, 2, 3))
                                            setTimeout(function () {
                                                sac.push(new missiles(boite.x - 100, boite.y + 180, 50, 25, "red", 0.5, 1, 3))
                                                sac.push(new missiles(boite.x + boite.w + 100, boite.y + 180, 50, 25, "red", 0.5, 2, 3))
                                                setTimeout(function () {
                                                    sac.push(new missiles(boite.x - 100, boite.y + 210, 50, 25, "red", 0.5, 1, 3))
                                                    sac.push(new missiles(boite.x + boite.w + 100, boite.y + 210, 50, 25, "red", 0.5, 2, 3))

                                                }, 100)
                                            }, 100)
                                        }, 100)
                                    }, 100)
                                }, 100)
                            }, 100)
                        }, 100)
                    }, 600)
                } else if (attack == 28) {
                    setTimeout(function () {
                        gravity = -1
                        attack = 29
                        sac.push(new missiles(boite.x - 100, boite.y + 240, 50, 25, "red", 0.5, 1, 3))
                        sac.push(new missiles(boite.x + boite.w + 100, boite.y + 240, 50, 25, "red", 0.5, 2, 3))
                        setTimeout(function () {
                            sac.push(new missiles(boite.x - 100, boite.y + 210, 50, 25, "red", 0.5, 1, 3))
                            sac.push(new missiles(boite.x + boite.w + 100, boite.y + 210, 50, 25, "red", 0.5, 2, 3))
                            setTimeout(function () {
                                sac.push(new missiles(boite.x - 100, boite.y + 180, 50, 25, "red", 0.5, 1, 3))
                                sac.push(new missiles(boite.x + boite.w + 100, boite.y + 180, 50, 25, "red", 0.5, 2, 3))
                                setTimeout(function () {
                                    sac.push(new missiles(boite.x - 100, boite.y + 150, 50, 25, "red", 0.5, 1, 3))
                                    sac.push(new missiles(boite.x + boite.w + 100, boite.y + 150, 50, 25, "red", 0.5, 2, 3))
                                    setTimeout(function () {
                                        sac.push(new missiles(boite.x - 100, boite.y + 120, 50, 25, "red", 0.5, 1, 3))
                                        sac.push(new missiles(boite.x + boite.w + 100, boite.y + 120, 50, 25, "red", 0.5, 2, 3))
                                        setTimeout(function () {
                                            sac.push(new missiles(boite.x - 100, boite.y + 90, 50, 25, "red", 0.5, 1, 3))
                                            sac.push(new missiles(boite.x + boite.w + 100, boite.y + 90, 50, 25, "red", 0.5, 2, 3))
                                            setTimeout(function () {
                                                sac.push(new missiles(boite.x - 100, boite.y + 60, 50, 25, "red", 0.5, 1, 3))
                                                sac.push(new missiles(boite.x + boite.w + 100, boite.y + 60, 50, 25, "red", 0.5, 2, 3))
                                                setTimeout(function () {
                                                    sac.push(new missiles(boite.x - 100, boite.y + 30, 50, 25, "red", 0.5, 1, 3))
                                                    sac.push(new missiles(boite.x + boite.w + 100, boite.y + 30, 50, 25, "red", 0.5, 2, 3))

                                                }, 100)
                                            }, 100)
                                        }, 100)
                                    }, 100)
                                }, 100)
                            }, 100)
                        }, 100)
                    }, 600)
                } else if (attack == 29) {
                    attack = 30
                    if (wait == false) {
                        wait = true
                        setTimeout(function () {
                            sac.push(new missiles(boite.x - 200, boite.y, 100, 100, "red", 0.5, 1, 3))
                            sac.push(new missiles(boite.x + boite.w + 100, boite.y + boite.h - 100, 100, 100, "red", 0.5, 2, 3))
                            attack = 31
                            wait = false
                        }, 700)
                    }

                } else if (attack == 31) {
                    sacb.push(new missiles(0, boite.y, 10, boite.h, "lightblue", 4.5, 1))
                }

            }

        }


        function attack2() {
            if (phase == 1 && transition == false && speak == false) {
                if (attack == 4) {
                    sac.push(new missiles(boite.x + Math.random() * boite.w, boite.y, 15, 15, "red", 4, 4))
                    if (wait == false) {
                        wait = true
                        setTimeout(end, 10000)
                    }
                } else if (attack == 5) {
                    sac.push(new missiles(boite.x + Math.random() * boite.w, boite.y + boite.h, 15, 15, "red", 4, 3))
                    if (wait == false) {
                        wait = true
                        setTimeout(end, 10000)
                    }
                }
            }

        }

        function attack3() {
            if (phase == 1 && transition == false && speak == false) {
                if (attack == 6) {
                    sac.push(new missiles(boite.x + Math.random() * boite.w / 1.3, 10, 20, 20, "red", 2, -1, 2, 2))
                    sac.push(new missiles(boite.x + Math.random() * boite.w / 1.3, boite.y + boite.h - 20, 20, 20, "red", -2, -1, 2, -2))
                    if (wait == false) {
                        wait = true
                        setTimeout(end, 7000)
                    }
                } else if (attack == 7) {
                    sac.push(new missiles(boite.x, boite.y + Math.random() * boite.h / 1.3, 20, 20, "red", 2, -1, 2, 2))
                    sac.push(new missiles(boite.x + boite.w - 20, boite.y + Math.random() * boite.h / 1.3, 20, 20, "red", -2, -1, 2, -2))
                    if (wait == false) {
                        wait = true
                        setTimeout(end, 7000)
                    }
                } else if (attack == 10) {
                    sac.push(new missiles(canvas.width, boite.y, 10, Math.random() * boite.h / 1.3, "red", 0.1, 2, 13))
                    if (wait == false) {
                        wait = true
                        setTimeout(end, 9000)
                    }
                } else if (attack == 11) {
                    sac.push(new missiles(canvas.width, boite.y + boite.h - 10, 10, 10, "red", 4, 2))
                    sac.push(new missiles(canvas.width + 30, boite.y + boite.h - 30, 10, 30, "red", 4, 2))
                    sac.push(new missiles(canvas.width + 60, boite.y + boite.h - 50, 10, 50, "red", 4, 2))
                    sac.push(new missiles(canvas.width + 90, boite.y + boite.h - 70, 10, 70, "red", 4, 2))
                    sac.push(new missiles(canvas.width + 120, boite.y + boite.h - 90, 10, 90, "red", 4, 2))
                    sac.push(new missiles(canvas.width + 150, boite.y + boite.h - 110, 10, 110, "red", 4, 2))
                    sac.push(new missiles(canvas.width + 180, boite.y + boite.h - 130, 10, 130, "red", 4, 2))
                    sac.push(new missiles(canvas.width + 210, boite.y + boite.h - 130, 10, 130, "red", 4, 2))
                    sac.push(new missiles(canvas.width + 240, boite.y + boite.h - 110, 10, 110, "red", 4, 2))
                    sac.push(new missiles(canvas.width + 270, boite.y + boite.h - 90, 10, 90, "red", 4, 2))
                    sac.push(new missiles(canvas.width + 300, boite.y + boite.h - 70, 10, 70, "red", 4, 2))
                    sac.push(new missiles(canvas.width + 330, boite.y + boite.h - 50, 10, 50, "red", 4, 2))
                    sac.push(new missiles(canvas.width + 360, boite.y + boite.h - 30, 10, 30, "red", 4, 2))
                    sac.push(new missiles(canvas.width + 390, boite.y + boite.h - 10, 10, 10, "red", 4, 2))
                    if (wait == false) {
                        wait = true
                        setTimeout(end, 8000)
                    }
                } else if (attack == 12) {
                    sac.push(new missiles(0, boite.y + boite.h - 10, 10, 10, "red", 4, 1))
                    sac.push(new missiles(-30, boite.y + boite.h - 30, 10, 30, "red", 4, 1))
                    sac.push(new missiles(-60, boite.y + boite.h - 50, 10, 50, "red", 4, 1))
                    sac.push(new missiles(-90, boite.y + boite.h - 70, 10, 70, "red", 4, 1))
                    sac.push(new missiles(-120, boite.y + boite.h - 90, 10, 90, "red", 4, 1))
                    sac.push(new missiles(-150, boite.y + boite.h - 110, 10, 110, "red", 4, 1))
                    sac.push(new missiles(-180, boite.y + boite.h - 130, 10, 130, "red", 4, 1))
                    sac.push(new missiles(-210, boite.y + boite.h - 130, 10, 130, "red", 4, 1))
                    sac.push(new missiles(-240, boite.y + boite.h - 110, 10, 110, "red", 4, 1))
                    sac.push(new missiles(-270, boite.y + boite.h - 90, 10, 90, "red", 4, 1))
                    sac.push(new missiles(-300, boite.y + boite.h - 70, 10, 70, "red", 4, 1))
                    sac.push(new missiles(-330, boite.y + boite.h - 50, 10, 50, "red", 4, 1))
                    sac.push(new missiles(-360, boite.y + boite.h - 30, 10, 30, "red", 4, 1))
                    sac.push(new missiles(-390, boite.y + boite.h - 10, 10, 10, "red", 4, 1))
                    if (wait == false) {
                        wait = true
                        setTimeout(end, 8000)
                    }
                } else if (attack == 13) {
                    gravity = Math.floor(Math.random() * 4)
                    if (gravity == 0) {
                        sac.push(new missiles(0, boite.y + boite.h - 50, 10, 50, "red", 5, 1))
                        sac.push(new missiles(canvas.width, boite.y + boite.h - 50, 10, 50, "red", 5, 2))
                    } else if (gravity == 1) {
                        sac.push(new missiles(0, boite.y, 10, 50, "red", 5, 1))
                        sac.push(new missiles(canvas.width, boite.y, 10, 50, "red", 5, 2))
                    } else if (gravity == 2) {
                        sac.push(new missiles(boite.x, -350, 50, 10, "red", 5, 4))
                        sac.push(new missiles(boite.x, canvas.height + 250, 50, 10, "red", 5, 3))
                    } else if (gravity == 3) {
                        sac.push(new missiles(boite.x + boite.w - 50, -350, 50, 10, "red", 5, 4))
                        sac.push(new missiles(boite.x + boite.w - 50, canvas.height + 250, 50, 10, "red", 5, 3))
                    }
                    if (wait == false) {
                        wait = true
                        setTimeout(end, 15000)
                    }
                } else if (attack == 15) {
                    sac.push(new missiles(0, boite.y, 10, Math.random() * boite.h / 1.3, "red", 0.1, 1, 13))
                    if (wait == false) {
                        wait = true
                        setTimeout(end, 9000)
                    }

                } else if (attack == 17) {
                    sac.push(new missiles(-40, joueur.y, 40, 20, "red", 5, 1))
                    setTimeout(function () {
                        sac.push(new missiles(canvas.width, joueur.y, 40, 20, "red", 5, 2))
                        setTimeout(function () {
                            sac.push(new missiles(joueur.x, canvas.height, 20, 40, "red", 5, 3))
                            setTimeout(function () {
                                sac.push(new missiles(joueur.x, -40, 20, 40, "red", 5, 4))
                            }, 1000)
                        }, 1000)
                    }, 500)
                    if (wait == false) {
                        wait = true
                        setTimeout(end, 9000)
                    }

                } else if (attack == 18) {
                    sac.push(new missiles(-40, joueur.y, 40, 20, "red", 1.5, 1))
                    setTimeout(function () {
                        sac.push(new missiles(joueur.x, -40, 20, 40, "red", 1, 4))
                        setTimeout(function () {
                            sac.push(new missiles(joueur.x, canvas.height, 20, 40, "red", 1, 3))
                            setTimeout(function () {
                                sac.push(new missiles(canvas.width, joueur.y, 40, 20, "red", 1.5, 2))
                            }, 400)
                        }, 400)
                    }, 200)
                    if (wait == false) {
                        wait = true
                        setTimeout(end, 13000)
                    }

                } else if (attack == 19) {
                    sacb.push(new missiles(0, boite.y, 10, boite.h, "lightblue", 3, 1))
                    saco.push(new missiles(canvas.width, boite.y, 10, boite.h, "orange", 3, 2))
                    if (wait == false) {
                        wait = true
                        setTimeout(end, 13000)
                    }
                } else if (attack == 20) {
                    sacb.push(new missiles(0, boite.y, 10, boite.h, "lightblue", 0.08, 1, 13))
                    setTimeout(function () { saco.push(new missiles(canvas.width, boite.y, 10, boite.h, "orange", 0.08, 2, 13)) }, 1000)
                    setTimeout(function () { saco.push(new missiles(0, boite.y, 10, boite.h, "orange", 0.08, 1, 13)) }, 1500)
                    setTimeout(function () { sacb.push(new missiles(canvas.width, boite.y, 10, boite.h, "lightblue", 0.08, 2, 13)) }, 2500)
                    if (wait == false) {
                        wait = true
                        setTimeout(end, 13000)
                    }
                }
            }

            if (phase == 3 && transition == false && combat2 == true && speak == false) {
                if (attack == 2) {
                    sac.push(new missiles(0, boite.y, 10, Math.random() * boite.h / 1.3, "red", 3, 1, 1))
                    sacb.push(new missiles(0, boite.y, 10, boite.h, "lightblue", 3, 1))
                    setTimeout(function () {
                        sac.push(new missiles(canvas.width, boite.y, 10, Math.random() * boite.h / 1.3, "red", 3, 2, 1))
                        saco.push(new missiles(canvas.width, boite.y, 10, boite.h, "orange", 3, 2))
                    }, 1000)
                    if (wait == false) {
                        wait = true
                        setTimeout(end, 14500)
                    }
                } else if (attack == 3) {
                    sacb.push(new missiles(0, boite.y, 10, boite.h, "lightblue", 0.08, 1, 13))
                    setTimeout(function () { saco.push(new missiles(0, boite.y, 10, boite.h, "orange", 0.08, 1, 13)) }, 2000)
                } else if (attack == 4) {
                    saco.push(new missiles(canvas.width, boite.y, 10, boite.h, "orange", 0.08, 2, 13))
                    setTimeout(function () { sacb.push(new missiles(canvas.width, boite.y, 10, boite.h, "lightblue", 0.08, 2, 13)) }, 2000)
                } else if (attack == 7) {
                    sacb.push(new missiles(boite.x + Math.random() * boite.w / 1.3, 10, 20, 20, "lightblue", 1, -1, 2, 1))
                    sacb.push(new missiles(boite.x + Math.random() * boite.w / 1.3, boite.y + boite.h - 20, 20, 20, "lightblue", -1, -1, 2, -1))
                    saco.push(new missiles(boite.x, boite.y + Math.random() * boite.h / 1.3, 20, 20, "orange", 1, -1, 2, 1))
                    saco.push(new missiles(boite.x + boite.w - 20, boite.y + Math.random() * boite.h / 1.3, 20, 20, "orange", -1, -1, 2, -1))
                    if (wait == false) {
                        wait = true
                        setTimeout(end, 14000)
                    }
                } else if (attack == 6) {
                    sac.push(new missiles(joueur.x - 130, joueur.y, 50, 50, "red", 0.02, 1, 3))
                    sac.push(new missiles(joueur.x + 130, joueur.y, 50, 50, "red", 0.02, 2, 3))
                    sac.push(new missiles(joueur.x, joueur.y + 130, 50, 50, "red", 0.02, 3, 3))
                    sac.push(new missiles(joueur.x, joueur.y - 130, 50, 50, "red", 0.02, 4, 3))
                    setTimeout(function () {
                        sac.push(new missiles(joueur.x - 130, joueur.y - 130, 50, 50, "red", 0.02, 5, 3))
                        sac.push(new missiles(joueur.x - 130, joueur.y + 130, 50, 50, "red", 0.02, 7, 3))
                        sac.push(new missiles(joueur.x + 130, joueur.y - 130, 50, 50, "red", 0.02, 6, 3))
                        sac.push(new missiles(joueur.x + 130, joueur.y + 130, 50, 50, "red", 0.02, 8, 3))
                    }, 1000)

                    if (wait == false) {
                        wait = true
                        setTimeout(end, 20000)
                    }
                } else if (attack == 8) {
                    sac.push(new missiles(joueur.x, -40, 20, 40, "red", 1.5, 4))
                    sac.push(new missiles(-40, joueur.y, 40, 20, "red", 8, 1))
                    sac.push(new missiles(canvas.width, joueur.y, 40, 20, "red", 15, 2))
                    if (wait == false) {
                        wait = true
                        setTimeout(end, 20000)
                    }
                } else if (attack == 11) {
                    gravity = 1
                    sac.push(new missiles(0, boite.y, 10, 100, "red", 7, 1))
                    sac.push(new missiles(canvas.width, boite.y, 10, 100, "red", 7, 2))
                    if (wait == false) {
                        wait = true
                        setTimeout(end, 2000)
                    }
                } else if (attack == 12) {
                    sac.push(new missiles(0, boite.y, 10, Math.random() * boite.h / 2.1 + 58, "red", 6, 1, 1))
                    setTimeout(function () { sac.push(new missiles(canvas.width, boite.y, 10, Math.random() * boite.h / 2.1 + 58, "red", 6, 2, 1)) }, 1500)
                    if (wait == false) {
                        wait = true
                        setTimeout(end, 20000)
                    }
                } else if (attack == 13) {
                    attack = 13.5
                    sac.push(new missiles(0, boite.y, 10, 10, "red", 4, 1, 1))
                    sac.push(new missiles(-50, boite.y, 10, 30, "red", 4, 1, 1))
                    sac.push(new missiles(-100, boite.y, 10, 50, "red", 4, 1, 1))
                    sac.push(new missiles(-150, boite.y, 10, 70, "red", 4, 1, 1))
                    sac.push(new missiles(-200, boite.y, 10, 90, "red", 4, 1, 1))
                    sac.push(new missiles(-250, boite.y, 10, 110, "red", 4, 1, 1))
                    sac.push(new missiles(-300, boite.y, 10, 130, "red", 4, 1, 1))
                    sac.push(new missiles(-350, boite.y, 10, 130, "red", 4, 1, 1))
                    sac.push(new missiles(-400, boite.y, 10, 110, "red", 4, 1, 1))
                    sac.push(new missiles(-450, boite.y, 10, 90, "red", 4, 1, 1))
                    sac.push(new missiles(-500, boite.y, 10, 70, "red", 4, 1, 1))
                    sac.push(new missiles(-550, boite.y, 10, 50, "red", 4, 1, 1))
                    sac.push(new missiles(-600, boite.y, 10, 30, "red", 4, 1, 1))
                    sac.push(new missiles(-650, boite.y, 10, 10, "red", 4, 1, 1))
                    setTimeout(function () {
                        sac = []
                        attack = 14
                    }, 6500)
                    if (wait == false) {
                        wait = true
                        setTimeout(end, 21000)
                        setTimeout(function () {
                            attack = 14
                        }, 21000)
                    }
                } else if (attack == 14) {
                    attack = 13.5
                    sac.push(new missiles(canvas.width, boite.y, 10, 130, "red", 4, 2, 1))
                    sac.push(new missiles(canvas.width + 50, boite.y, 10, 110, "red", 4, 2, 1))
                    sac.push(new missiles(canvas.width + 100, boite.y, 10, 90, "red", 4, 2, 1))
                    sac.push(new missiles(canvas.width + 150, boite.y, 10, 70, "red", 4, 2, 1))
                    sac.push(new missiles(canvas.width + 200, boite.y, 10, 50, "red", 4, 2, 1))
                    sac.push(new missiles(canvas.width + 250, boite.y, 10, 30, "red", 4, 2, 1))
                    sac.push(new missiles(canvas.width + 300, boite.y, 10, 10, "red", 4, 2, 1))
                    sac.push(new missiles(canvas.width + 350, boite.y, 10, 10, "red", 4, 2, 1))
                    sac.push(new missiles(canvas.width + 400, boite.y, 10, 30, "red", 4, 2, 1))
                    sac.push(new missiles(canvas.width + 450, boite.y, 10, 50, "red", 4, 2, 1))
                    sac.push(new missiles(canvas.width + 500, boite.y, 10, 70, "red", 4, 2, 1))
                    sac.push(new missiles(canvas.width + 550, boite.y, 10, 90, "red", 4, 2, 1))
                    sac.push(new missiles(canvas.width + 600, boite.y, 10, 110, "red", 4, 2, 1))
                    sac.push(new missiles(canvas.width + 650, boite.y, 10, 130, "red", 4, 2, 1))
                    setTimeout(function () {
                        sac = []
                        attack = 13
                    }, 6500)
                } else if (attack == 24) {
                    sac.push(new missiles(-40, joueur.y, 40, 20, "red", 15, 1))
                    sac.push(new missiles(-100, joueur.y, 40, 20, "red", 15, 1))
                    sac.push(new missiles(-160, joueur.y, 40, 20, "red", 15, 1))
                    sac.push(new missiles(-220, joueur.y, 40, 20, "red", 15, 1))
                    sac.push(new missiles(-280, joueur.y, 40, 20, "red", 15, 1))
                    sac.push(new missiles(-340, joueur.y, 40, 20, "red", 15, 1))
                    if (wait == false) {
                        wait = true
                        setTimeout(function () {
                            sac.push(new missiles(joueur.x, -100, 20, 40, "red", 10, 4))
                            setTimeout(function () {
                                sac.push(new missiles(joueur.x, canvas.height, 20, 40, "red", 10, 3))
                                setTimeout(function () {
                                    sac.push(new missiles(canvas.width, joueur.y, 40, 20, "red", 15, 2))
                                    wait = false
                                    attack = 25
                                }, 200)
                            }, 200)
                        }, 1000)
                    }

                } else if (attack == 25) {
                    sac.push(new missiles(canvas.width, joueur.y, 40, 20, "red", 15, 2))
                    sac.push(new missiles(canvas.width + 60, joueur.y, 40, 20, "red", 15, 2))
                    sac.push(new missiles(canvas.width + 120, joueur.y, 40, 20, "red", 15, 2))
                    sac.push(new missiles(canvas.width + 180, joueur.y, 40, 20, "red", 15, 2))
                    sac.push(new missiles(canvas.width + 240, joueur.y, 40, 20, "red", 15, 2))
                    sac.push(new missiles(canvas.width + 300, joueur.y, 40, 20, "red", 15, 2))
                    if (wait == false) {
                        wait = true
                        setTimeout(function () {
                            sac.push(new missiles(joueur.x, canvas.height, 20, 40, "red", 10, 3))
                            setTimeout(function () {
                                sac.push(new missiles(joueur.x, -150, 20, 40, "red", 10, 4))
                                setTimeout(function () {
                                    sac.push(new missiles(-40, joueur.y, 40, 20, "red", 15, 1))
                                    setTimeout(function () {
                                        wait = false
                                        attack = 26
                                    }, 500)
                                }, 200)
                            }, 200)
                        }, 1000)
                    }

                } else if (attack == 31) {
                    saco.push(new missiles(boite.x, canvas.height, boite.w, 10, "orange", 7, 3))
                    if (wait == false) {
                        wait = true
                        setTimeout(function () {
                            wait = false
                            attack = 32
                            setTimeout(function () {
                                attack = 33
                            }, 2000)
                        }, 8000)
                    }

                } else if (attack == 34) {
                    attack = 35
                    sacb.push(new missiles(boite.x, canvas.height, boite.w, 10, "lightblue", 10, 3))
                    setTimeout(function () {
                        gravity = -1
                        sac = []
                        sacb = []
                        saco = []
                        setTimeout(function () {
                            document.getElementById("container16").style.display = "none"
                            document.getElementById("container17").style.display = "block"
                        }, 1000)
                        setTimeout(function () {
                            music.src = "menumusic.mp3"
                            document.getElementById("text").style.display = "none"
                            document.getElementById("monCanvas").style.display = "none"
                            document.getElementById("vieCanvas").style.display = "none"
                            document.getElementById("container17").style.display = "none"
                            document.getElementById("container18").style.display = "block"
                        }, 8700)
                        setTimeout(function () {
                            wait = false
                            combat = false
                            contour.x = 0
                            contour.w = 1000
                            boite.x = 10
                            boite.w = 980
                            menu = 0
                            dialogue = 0
                            phase = 1
                            lastatt = -1
                            speak = false
                            checkpoints = false
                            attack = -1
                            joueur.x = 50
                            joueur.y = canvas.height / 2.3
                            bouton = 0
                            bossvie.w = 200
                            healthbar.w = 100
                            items.nood = 0
                            items.ster = 0
                            document.getElementById("vieCanvas").style.display = "block"
                            document.getElementById("monCanvas").style.display = "block"
                            document.getElementById("container18").style.display = "none"
                            document.getElementById("container0").style.display = "block"
                        }, 13000)
                    }, 5000)
                }



            }

        }

        function attack4() {
            if (phase == 1 && transition == false && speak == false) {
                if (attack == 8) {
                    sac.push(new missiles(0, boite.y, 10, 190, "red", 5, 1, 1))
                    if (wait == false) {
                        wait = true
                        setTimeout(end, 7000)
                    }
                } else if (attack == 9) {
                    sac.push(new missiles(joueur.x - 230, joueur.y, 50, 20, "red", 0.05, 1, 3))
                    sac.push(new missiles(joueur.x + 200, joueur.y, 50, 20, "red", 0.05, 2, 3))
                    sac.push(new missiles(joueur.x, joueur.y + 200, 20, 50, "red", 0.05, 3, 3))
                    sac.push(new missiles(joueur.x, joueur.y - 230, 20, 50, "red", 0.05, 4, 3))
                    if (wait == false) {
                        wait = true
                        setTimeout(end, 7000)
                    }
                } else if (attack == 14) {
                    sac.push(new missiles(canvas.width, boite.y, 10, 20, "red", 5, 2, 1))
                    if (wait == false) {
                        wait = true
                        setTimeout(end, 7000)
                    }
                } else if (attack == 16) {
                    sac.push(new missiles(joueur.x - 130, joueur.y - 130, 25, 25, "red", 0.5, 5, 3))
                    sac.push(new missiles(joueur.x - 130, joueur.y + 130, 25, 25, "red", 0.5, 7, 3))
                    sac.push(new missiles(joueur.x + 130, joueur.y - 130, 25, 25, "red", 0.5, 6, 3))
                    sac.push(new missiles(joueur.x + 130, joueur.y + 130, 25, 25, "red", 0.5, 8, 3))
                    if (wait == false) {
                        wait = true
                        setTimeout(end, 7000)
                    }
                }
            }

            if (phase == 3 && transition == false && combat2 == true && speak == false) {
                if (attack == 18) {
                    sac.push(new missiles(0, boite.y, 10, boite.h / 2, "red", 6, 1))
                    sac.push(new missiles(canvas.width, boite.y + boite.h / 2, 10, boite.h / 2, "red", 6, 2))
                    if (wait == false) {
                        wait = true
                        setTimeout(function () {
                            attack = 19
                            wait = false
                        }, 5000)
                    }
                } else if (attack == 19) {
                    sac.push(new missiles(canvas.width, boite.y, 10, boite.h / 2, "red", 6, 2))
                    sac.push(new missiles(0, boite.y + boite.h / 2, 10, boite.h / 2, "red", 6, 1))
                    if (wait == false) {
                        wait = true
                        setTimeout(function () {
                            attack = 19.5
                            wait = false
                        }, 5000)
                        setTimeout(function () {
                            attack = 20
                            wait = false
                        }, 6500)
                    }
                }
            }

        }

        function attack5() {

            if (phase == 3 && transition == false && combat2 == true && speak == false) {
                if (attack == 9) {
                    sac.push(new missiles(0, 0, 0, 0, "red", 0, Math.floor(Math.random() * 5), 4))
                    if (wait == false) {
                        wait = true
                        setTimeout(end, 20000)
                    }
                } else if (attack == 10) {
                    sac.push(new missiles(0, boite.y, 10, 200, "red", 5, 1, 1))
                    sac.push(new missiles(canvas.width, boite.y, 10, 200, "red", 5, 2, 1))
                    if (wait == false) {
                        wait = true
                        setTimeout(function () {
                            attack = 10.5
                        }, 10000)
                        setTimeout(function () {
                            attack = 11
                            gravity = 1
                            wait = false
                        }, 13000)
                    }
                } else if (attack == 33) {
                    gravity = 0
                    sac.push(new missiles(0, boite.y, 10, 200, "red", 5, 1, 1))
                    sac.push(new missiles(canvas.width, boite.y, 10, 200, "red", 5, 2, 1))
                    if (wait == false) {
                        wait = true
                        setTimeout(function () {
                            attack = 33.5
                        }, 5000)
                        setTimeout(function () {
                            attack = 34
                            gravity = 1
                            wait = false
                        }, 7000)
                    }
                }
            }
        }

        //applique les dégats
        function checkcollision() {
            for (i = 0; i < sac.length; i++) {
                if (collision(sac[i], joueur) && hit == false && healthbar.w != -101) {
                    hurt.play()
                    hit = true
                    setTimeout(function () { hit = false }, 2000)
                    healthbar.w -= degat
                    if (items.nood >= 1) {
                        healthbar.w += degat / 2
                    }
                }

                if (collision(sac[i], joueur) && gravity == 4) {
                    sac[i].h = 0
                }

                if (sac[i].y > canvas.height + 500 || sac[i].y < -500 || sac[i].x > canvas.width + 660 || sac[i].x < -660) {
                    sac.splice(i, 1)
                }

                /* if (sac[i].y> boite.y + boite.h || sac[i].y < boite.y || sac[i].x> boite.x + boite.w || sac[i].x < boite.x) {
                     sac.splice(i, 1)
                 }*/

            }

//dont move
            for (i = 0; i < sacb.length; i++) {
                if (collision(sacb[i], joueur) && hit == false && lastxy.x != joueur.x && healthbar.w != -101 || collision(sacb[i], joueur) && hit == false && lastxy.y != joueur.y && healthbar.w != -101) {
                    hurt.play()
                    hit = true
                    healthbar.w -= degat
                    setTimeout(function () { hit = false }, 2000)
                    if (items.nood >= 1) {
                        healthbar.w += degat / 2
                    }
                }
            }

//move
            for (i = 0; i < saco.length; i++) {
                if (collision(saco[i], joueur) && hit == false && lastxy.x == joueur.x && lastxy.y == joueur.y && healthbar.w != -101) {
                    hurt.play()
                    hit = true
                    healthbar.w -= degat
                    setTimeout(function () { hit = false }, 2000)
                    if (items.nood >= 1) {
                        healthbar.w += degat / 2
                    }
                }
            }

//bouclier
            for (i = 0; i < sac.length; i++) {
                if (collision(sac[i], shield)) {
                    sac.splice(i, 1)
                }
            }

        }

        //fin attaque et transition entre phase 1 et 2
        function end() {
            if (phase != 3) {
                attack = -1
            } else {
                combat2 = false
            }
            if (bossvie.w == 10 && phase == 2) {
                music.src = "angry.wav"
                setTimeout(function () {
                    document.getElementById("container8").style.display = "none"
                    document.getElementById("container9").style.display = "block"
                    speak = true
                    ct.font = "25px Comic Sans MS"
                    ct.fillStyle = "white"
                    ct.fillText("You... You ", 10, 50)
                    ct.fillStyle = "red"
                    ct.fillText("wounded", 130, 50)
                    ct.fillStyle = "white"
                    ct.fillText("me?", 240, 50)
                    setTimeout(function () {
                        phase = 3
                        speak = false
                        returns()
                        document.getElementById("container9").style.display = "none"
                        document.getElementById("container2").style.display = "block"
                    }, 5000)
                }, 2500)
            }
            if (bossvie.w == 10 && phase == 1) {
                speak = true
                ct.font = "25px Comic Sans MS"
                ct.fillStyle = "white"
                ct.fillText("You are really strong!", 10, 50)
                setTimeout(function () {
                    speak = false
                }, 3000)
                setTimeout(function () {
                    speak = true
                    ct.fillText("We played enough for today.", 10, 50)
                }, 3100)
                setTimeout(function () {
                    speak = false
                }, 6000)
                setTimeout(function () {
                    speak = true
                    ct.fillText("Spare me and you could", 10, 50)
                    ct.fillText("go play another game.", 10, 80)
                }, 6100)
                setTimeout(function () {
                    phase = 2
                    speak = false
                    returns()
                }, 10000)
            }
            if (bossvie.w > 10 && phase == 1 || phase == 3) {
                setTimeout(returns, 3000)
            }


        }

        //retour apres attaque
        function returns() {
            if (bouton == 1 || bouton == 1.1) {
                joueur.y = 353
                joueur.x = 50
            } else if (bouton == 2.7) {
                joueur.y = 353
                joueur.x = 300
            } else if (bouton == 3) {
                joueur.y = 353
                joueur.x = 550
            } else if (bouton == 4.9) {
                joueur.y = 353
                joueur.x = 800
            }
            wait = false
            combat = false
            sac = []
            sacb = []
            saco = []
            bouton = 0

            contour.x = 0
            contour.w = 1000
            boite.x = 10
            boite.w = 980
            gravity = -1
        }

//mort...
        function mort() {
            if (healthbar.w <= 0 && menu == 4) {
                healthbar.w = 100
            }
            if (healthbar.w <= 0 && healthbar.w >= -100 && menu == 3) {
                soulshatter.play()
                music.src = ""
                healthbar.w = -101
                document.getElementById("container5").style.display = "block"
                document.getElementById("container").style.display = "none"
                document.getElementById("monCanvas").style.display = "none"
                document.getElementById("text").style.display = "none"
                document.getElementById("container2").style.display = "none"
                setTimeout(function () {
                    music.src = "gameovermusic.mp3"
                    document.getElementById("container5").style.display = "none"
                    document.getElementById("container7").style.display = "block"
                }, 4700)

                setTimeout(function () {
                    document.getElementById("container7").style.display = "none"
                    document.getElementById("container6").style.display = "block"
                }, 6700)

                setTimeout(function () {
                    dialogue = 0
                    attack = -1
                    combat2 = false
                    returns()
                    if (checkpoints == true && phase == 1 || checkpoints == false) {
                        music.src = "nutral.mp3"
                        phase = 1
                        bossvie.w = 200
                        document.getElementById("container").style.display = "block"
                    }
                    if (checkpoints == true && phase == 3) {
                        music.src = "angry.wav"
                        bossvie.w = 10
                        phase = 3
                        document.getElementById("container2").style.display = "block"
                    }
                    if (degat == 10) {
                        items.noodles = 3
                        items.steroids = 2
                        items.candy = 7
                        items.cake = 4
                        items.pie = 3
                    }
                    if (degat == 20) {
                        items.noodles = 2
                        items.steroids = 2
                        items.candy = 6
                        items.cake = 3
                        items.pie = 3
                    }
                    if (degat == 25) {
                        items.noodles = 2
                        items.steroids = 1
                        items.candy = 5
                        items.cake = 3
                        items.pie = 2
                    }
                    items.nood = 0
                    items.ster = 0
                    healthbar.w = 100
                    document.getElementById("container6").style.display = "none"
                    document.getElementById("monCanvas").style.display = "block"
                    document.getElementById("text").style.display = "block"
                }, 16500)
            }

        }

        //for blue and orange att
        setInterval(nomove, 100)
        function nomove() {
            lastxy.x = joueur.x
            lastxy.y = joueur.y
        }

        //loop
        function game() {
            if (65 in keyDown || 68 in keyDown || 87 in keyDown || 83 in keyDown) {
                    wasd = true
                }
            if (40 in keyDown || 39 in keyDown || 38 in keyDown || 37 in keyDown) {
                    wasd = false
                }

            music.play()
            c.clearRect(0, 0, canvas.width, canvas.height)
            cv.clearRect(0, 0, canvasv.width, canvasv.height)
            if (speak == false) { ct.clearRect(0, 0, canvast.width, canvast.height) }
            draw()
            if (wasd == false) { clavier()}
            if (wasd == true) {clavierwasd()}
            checkcollision()
            mort()
            setTimeout(game, 16.67)
        }
        game()

    </script>
</body>

</html>
